<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Vaccine Epidemiology</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology">
  <meta name="generator" content="bookdown 0.0.71 and GitBook 2.6.7">

  <meta property="og:title" content="Vaccine Epidemiology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology" />
  <meta name="github-repo" content="spatial-r/Vaccineepidemiology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Vaccine Epidemiology" />
  
  <meta name="twitter:description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology" />
  

<meta name="author" content="Bing Zhang">

<meta name="date" content="2016-05-22">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="bayesian-infectious-dynamics-model-in-discrete-time.html">
<link rel="next" href="spatial-temporal-multicomponent-model.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vaccine Epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html"><i class="fa fa-check"></i><b>2</b> Bayesian Infectious Dynamics Model in Discrete Time</a><ul>
<li class="chapter" data-level="2.1" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#model-and-parameters"><i class="fa fa-check"></i><b>2.2</b> Model and Parameters</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html"><i class="fa fa-check"></i><b>3</b> Reproduction numbers during epidemics</a><ul>
<li class="chapter" data-level="3.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#basic-reproduction-number"><i class="fa fa-check"></i><b>3.1</b> Basic reproduction number</a></li>
<li class="chapter" data-level="3.2" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#package-r0"><i class="fa fa-check"></i><b>3.2</b> Package R0</a><ul>
<li class="chapter" data-level="3.2.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#example-and-code"><i class="fa fa-check"></i><b>3.2.1</b> Example and code</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#package-epiestim"><i class="fa fa-check"></i><b>3.3</b> Package EpiEstim</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#example-and-code-1"><i class="fa fa-check"></i><b>3.3.1</b> Example and code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html"><i class="fa fa-check"></i><b>4</b> Spatial-temporal Multicomponent Model</a><ul>
<li class="chapter" data-level="4.1" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.1"><i class="fa fa-check"></i><b>4.1</b> 模型综述</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.2"><i class="fa fa-check"></i><b>4.2</b> 模型优点</a></li>
<li class="chapter" data-level="4.3" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3"><i class="fa fa-check"></i><b>4.3</b> 具体实例</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#sts"><i class="fa fa-check"></i><b>4.3.1</b> STS数据</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.2"><i class="fa fa-check"></i><b>4.3.2</b> 数据可视化</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.3"><i class="fa fa-check"></i><b>4.3.3</b> 模型拟合</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.4"><i class="fa fa-check"></i><b>4.3.4</b> 纳入协变量</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#power-law"><i class="fa fa-check"></i><b>4.3.5</b> Power-law</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#random-effect"><i class="fa fa-check"></i><b>4.3.6</b> Random effect</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.4"><i class="fa fa-check"></i><b>4.4</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html"><i class="fa fa-check"></i><b>5</b> Vaccine Epidemiology: A short insight</a><ul>
<li class="chapter" data-level="5.1" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#background"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#introduction-1"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-epdemiology"><i class="fa fa-check"></i><b>5.3</b> Vaccine Epdemiology</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-related-items"><i class="fa fa-check"></i><b>5.3.1</b> Vaccine-related Items</a></li>
<li class="chapter" data-level="5.3.2" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-strategies"><i class="fa fa-check"></i><b>5.3.2</b> Vaccine Strategies</a></li>
<li class="chapter" data-level="5.3.3" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#measure-indicators"><i class="fa fa-check"></i><b>5.3.3</b> Measure Indicators</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#conclusion"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html"><i class="fa fa-check"></i><b>6</b> Incomplete vaccination with an imperfect vaccine</a><ul>
<li class="chapter" data-level="6.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#background-1"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#introduction-2"><i class="fa fa-check"></i><b>6.2</b> Introduction</a><ul>
<li class="chapter" data-level="6.2.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#immunity-against-infection"><i class="fa fa-check"></i><b>6.2.1</b> Immunity against infection</a></li>
<li class="chapter" data-level="6.2.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#immunity-against-tramsimission-and-disease"><i class="fa fa-check"></i><b>6.2.2</b> Immunity against tramsimission and disease</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#method"><i class="fa fa-check"></i><b>6.3</b> Method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#data"><i class="fa fa-check"></i><b>6.3.1</b> Data</a></li>
<li class="chapter" data-level="6.3.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#model"><i class="fa fa-check"></i><b>6.3.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#results"><i class="fa fa-check"></i><b>6.4</b> Results</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Vaccine Epidemiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reproduction-numbers-during-epidemics" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Reproduction numbers during epidemics</h1>
<p><strong>Reprouction number</strong>, <strong>R</strong>, is the number of secondary cases generated by a single individual over its entire infectious period in a complete susceptile population , which is commonly used to characterize pathogen transmissibility during a epidemic. The monitoring of R over time provides the feedback on the effectiveness of interventions.</p>
<p>There are two R packages used to measure the reproduction number: <a href="http://mirrors.ustc.edu.cn/CRAN/web/packages/R0/index.html"><strong>R0</strong></a> and <a href="http://mirrors.ustc.edu.cn/CRAN/web/packages/EpiEstim/index.html"><strong>EpiEstim</strong></a>. The former package can calculate the <a href="https://en.wikipedia.org/wiki/Basic_reproduction_number"><strong>basic reproduction number(R0)</strong></a> and the <strong>time-varing reproduction number(Rt)</strong>, however, the latter package supplies a new framework to estimate the <strong>time-vary reproduction number</strong>. There are two papers which give the detail introduction to the packages,respectively and you can download them in <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3582628/pdf/1472-6947-12-147.pdf">here</a> and <a href="http://www.researchgate.net/publication/256666227_A_New_Framework_and_Software_to_Estimate_Time-Varying_Reproduction_Numbers_During_Epidemics">here</a>.</p>
<div id="basic-reproduction-number" class="section level2">
<h2><span class="header-section-number">3.1</span> Basic reproduction number</h2>
<p>The concept of reproduction number is firstly introduced by the work of <a href="https://en.wikipedia.org/wiki/Alfred_Lotka">Alfred Lotka</a> and <a href="https://en.wikipedia.org/wiki/Ronald_Ross">Ronald Ross</a> (PS: He received the Nobel Prize for Physiology or Medicine in 1902). However,the first modern application to the basic reproduction number in epidemiology was George MacDonald in 1952, who constructed population models on malaria. The R0 is a nonnegative value, if above 1 indicate that the disease will spread among a population, however, on the contrary, the infection will be die in the future. But <a href="http://www.thelancet.com/pdfs/journals/laninf/PIIS1473-3099(13)70358-X.pdf">some literatures</a> also emphasized that even when the R0 below one it can be transimitted during a long-distance flights.</p>
<p>A review of generic methods used to estimate transmissibility parameters during outbreaks was carried out. Most methods used the epidemic curve and the generation time distribution (Note: The generation time reflect the time lag between infection in a primary case and a secondary case). Overall, the epidemic curve can be finished by the surveillance data by the <strong>epicurve</strong> function in <a href="http://mirrors.ustc.edu.cn/CRAN/web/packages/epitools/index.html">epitools</a>package, however, the time distribution should be obtained from the time lag between all infectee/infector pairs and can’t be observed directly. Therefore, the <strong>serial interval distribution</strong> comes!</p>
</div>
<div id="package-r0" class="section level2">
<h2><span class="header-section-number">3.2</span> Package R0</h2>
<p>As aformentioned, the value of generation time was substituted with the serial interval distribution. In R0 package, the <strong>generation.time</strong> function can creat a discretized generation time distribution, which based on the tiem interval to choose. Two types of distribution can be used: <strong>Emperical distribution</strong> and <strong>Parametric distribution</strong>. The former requires the full specification of the distribution, however, the latter includes thress methods (gamma, lognormal and weibull distribution) and need the mean and standard deviation information. Aterlatively, you can use the maximum likelihood method on the observed time intervals between the symptom onsets in primary cases and secondary cases. The <strong>est.GT</strong> function do solve the process.</p>
<p>The package R0 includes five methods to calculate the basic reproduction number(also called initial number) and the time varying reproduction number:<strong>Attack Rate (AR)</strong>, <strong>Exponential Growth (EG)</strong>, <strong>Maximum Likelihood (ML)</strong>,<strong>Time-Dependant (TD)</strong>, and <strong>Sequential Bayesian (SB)</strong>. A detailed description to the method aboved can be found <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3582628/pdf/1472-6947-12-147.pdf">here</a>. Here, we just point out the difference among the five methods:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Attack Rate (AR)</strong>:<br />
 <strong>Background</strong>: Origined from the classical suspective-infective-recoery model. Attack rate is the percentage of population eventually infected.<br />
 <strong>Assumption</strong>: homogeneous mixing and closed population, No intervention.</p></li>
<li><p><strong>Exponential growth (EG)</strong>:<br />
 <strong>Background</strong>: Phenomenon about the exponential growth rate rate during the early phase of an outbreak.<br />
 <strong>Assumption</strong>: The growth rate of the study period in epidemic curve is expential( deviance based R-squared statistic guide the choose).</p></li>
<li><p><strong>Maximum Likelihood (ML)</strong>:<br />
<strong>Background</strong>: Phenomenon about the exponential growth rate rate during the early phase of an outbreak.<br />
<strong>Assumption</strong>: The secondary cases caused by an index case is <strong>Possion distribution</strong> with the excepted value of R. Moreover,the growth rate of study period in epidemic curve (from the first case on) is expential (Deviance based R-squared statistic guide the choose).</p></li>
<li><p><strong>Time-Dependant (TD)</strong>:<br />
 <strong>Background</strong>: A time-dependant method to compute the reproduction number by averaging over all the transmission networks compatible with observations.<br />
 <strong>Assumption</strong>: It is possible to account for the importation cases during the epidemic. The confidence interval for Rt can be obtained by simulation.</p></li>
<li><p><strong>Sequential Bayesian (SB)</strong>:<br />
 <strong>Background</strong>: Sequential bayesian estimation for the initial reproduction number. Origined from the approximation to tehe classical suspective-infective-recoery model with <strong>Possion distribution</strong>.<br />
 <strong>Assumption</strong>: Epidemic with a period of exponential growth and random mixing in the population.</p></li>
</ol>
<p>The <strong>estimate.R</strong> function can realize the aformentioned methods by the “method” arguement. Overall, the exponential growth method (ML and TD) performance was the least affacted by the either aggregation or the over dispersion.</p>
<div id="example-and-code" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Example and code</h3>
<p>Here, we used the dataset from the 1918 influenza pandemic and you can see its structure by the code “demo(Germany.1918)”. For simlicity, the example code only fixed on the Maximum Likelihood method. Overall, three steps to calculate the reproduction number: generate time distribution, estimate, and sensitively analysis. Analysis codes are as followed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">library</span>(R0);<span class="kw">options</span>(<span class="dt">device =</span> <span class="st">&quot;options&quot;</span>);<span class="kw">data</span>(Germany<span class="fl">.1918</span>) 
 epid =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2012-01-01&quot;</span>, <span class="st">&quot;2012-01-02&quot;</span>, <span class="st">&quot;2012-01-02&quot;</span>,<span class="st">&quot;2012-01-03&quot;</span>)
 epid.count =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>)
 GT.flu&lt;-<span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="fl">2.6</span>,<span class="dv">1</span>))  
 res.R &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(Germany<span class="fl">.1918</span>, <span class="dt">GT=</span>GT.flu,<span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;ML&quot;</span>))
 <span class="kw">plotfit</span>(res.R)</code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> ################ senzitively analysis ##################
 <span class="kw">sensitivity.analysis</span>(Germany<span class="fl">.1918</span>, <span class="dt">GT.type=</span><span class="st">&quot;gamma&quot;</span>,<span class="dt">GT.mean=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>), 
      <span class="dt">GT.sd.range=</span><span class="dv">1</span>, <span class="dt">begin=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">27</span>,<span class="dt">est.method=</span><span class="st">&quot;EG&quot;</span>, <span class="dt">sa.type=</span><span class="st">&quot;GT&quot;</span>)</code></pre></div>
<pre><code>##      GT.Type GT.Mean            GT.SD               R                 
## [1,] &quot;gamma&quot; &quot;1.58086588154581&quot; &quot;0.954292896527714&quot; &quot;1.28838902705086&quot;
## [2,] &quot;gamma&quot; &quot;2.04095089518824&quot; &quot;1.00627238027527&quot;  &quot;1.36339301322812&quot;
## [3,] &quot;gamma&quot; &quot;2.99986217575755&quot; &quot;1.03970173174022&quot;  &quot;1.53635327348974&quot;
## [4,] &quot;gamma&quot; &quot;3.99988819553508&quot; &quot;1.0405125530655&quot;   &quot;1.74123683125572&quot;
## [5,] &quot;gamma&quot; &quot;4.99994770859945&quot; &quot;1.04068406516072&quot;  &quot;1.97350896139042&quot;
##      CI.lower           CI.upper          
## [1,] &quot;1.27247564304064&quot; &quot;1.3046931144676&quot; 
## [2,] &quot;1.34280441223374&quot; &quot;1.38454612273489&quot;
## [3,] &quot;1.5041427715636&quot;  &quot;1.56966342209184&quot;
## [4,] &quot;1.6940358887725&quot;  &quot;1.79038129320771&quot;
## [5,] &quot;1.90795871942726&quot; &quot;2.04221224170092&quot;</code></pre>
</div>
</div>
<div id="package-epiestim" class="section level2">
<h2><span class="header-section-number">3.3</span> Package EpiEstim</h2>
<p>Most methdology to the reproduction number require the incidence data and the distribution of series interval. However, the estimate is right censored for the estimate of Rt requires the incidence data after time t. Moreover, some methods are sensitive to the selected time step or smoothing parameters. <a href="http://www.researchgate.net/profile/Anne_Cori2">Anne Cori</a> proposed a new framework and software[EpiEstim] to estimate the time-varying reproduction number. In the EpiEstim package, the time-varying reproduction number was divided into two types: Rt and Rtc. Here, we call Rt the <strong>instaneous reproduction number</strong> and call the Rtc the <strong>case reproduction number</strong>. The distinction between the Rtc and Rt is on the observation perspective: one is measured retrospectively, however,another is prospective based on the assumption that the infectious situation is constant in the future.</p>
<p>In practice, we assume that the infectious probability distribution <strong>ws</strong> of individual infected, depend on the individual biological factors such as symptom severity. Therefore, the infectious profile lie on the ws and the time since infection of the case, but indepent of the calendar time. Generaly, <strong>Rt</strong> can be estimate by the multiplication on the ratio of the number of new infectious cases at time t-1 and the ws. <strong>Rtc</strong> also called the cohort reproduction number becasue it counts the average number of secondary casued by a cohort infected at time t. Comparatively speaking, Rtc is more suitable for the situation that the contact rate and transmissibility can change over time, especially when the control measures are initiated. However, the correspending methods to the Rtc is inavailiable in EpiEstim package .</p>
<p>The EpiEstim package includes three types of methods to estimate the Rt: <strong>NonParametricSI</strong>， <strong>ParametricSI</strong>, and <strong>UncertainSI</strong>. The detained description to the method aboved can be foound <a href="http://aje.oxfordjournals.org/content/178/9/1505/suppl/DC1">here</a>.All the method can be applied by the <strong>EstimateR</strong> function.</p>
<ol style="list-style-type: decimal">
<li>For method <strong>“NonParametricSI”</strong>, the discrete distribution of the serial interval is directly speciﬁed in the argument “SI.Distr”;<br />
</li>
<li>For method <strong>“ParametricSI”</strong>, the mean and standard deviation of the continuous distribution of the serial interval are given in the arguments “Mean.SI”&quot; and “Std.SI”, which is derived automatically using “DiscrSI”;<br />
</li>
<li>For method <strong>“UncertainSI”</strong>, mean and standard deviation of the serial interval vary according to truncated normal distributions.Firstly, we sample the mean from its truncated normal distribution(with mean Mean.SI,standard deviation Std.Mean.SI, minimum Min.Mean.SI and maximum Max.Mean.SI). Then,we sample the standard deviation from its truncated normal distribution (with mean Std.SI, standard deviation Std.Std.SI, minimum Min.Std.SI and maximum Max.Std.SI).</li>
</ol>
<div id="example-and-code-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Example and code</h3>
<p>Here, we use the dataset about the pendemic influenza in a school in Pennsylvania, 2009. You can see the structure of the dataset by the code “demo(Flu2009)”. Due the article length, we just give the result of the method “NonParametricSI”. The analysis code is as followed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(EpiEstim)
 <span class="kw">data</span>(<span class="st">&quot;Flu2009&quot;</span>)
## estimate the instantaneous reproduction number (method &quot;NonParametricSI&quot;) 
<span class="kw">EstimateR</span>(Flu2009$Incidence, <span class="dt">T.Start=</span><span class="dv">2</span>:<span class="dv">26</span>, <span class="dt">T.End=</span><span class="dv">8</span>:<span class="dv">32</span>, <span class="dt">method=</span><span class="st">&quot;NonParametricSI&quot;</span>, <span class="dt">SI.Distr=</span>Flu2009$SI.Distr, <span class="dt">plot=</span><span class="ot">TRUE</span>, <span class="dt">leg.pos=</span><span class="kw">xy.coords</span>(<span class="dv">1</span>,<span class="dv">3</span>)) </code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre><code>## $R
##    T.Start T.End   Mean(R)     Std(R) Quantile.0.025(R) Quantile.0.05(R)
## 1        2     8 1.7356089 0.40908694        1.02863184        1.1218113
## 2        3     9 1.7490494 0.36470202        1.10874730        1.1953991
## 3        4    10 1.5370427 0.30740855        0.99469301        1.0686828
## 4        5    11 1.4316392 0.27055438        0.95131387        1.0175191
## 5        6    12 1.4223487 0.25143809        0.97288543        1.0355344
## 6        7    13 1.6349410 0.25227688        1.17832168        1.2432610
## 7        8    14 1.6636221 0.23295369        1.23867595        1.2998676
## 8        9    15 1.6156800 0.20686663        1.23586721        1.2911239
## 9       10    16 1.4340033 0.17651360        1.10905802        1.1565305
## 10      11    17 1.4083724 0.16155139        1.10963727        1.1535884
## 11      12    18 1.2477516 0.14219449        0.98470606        1.0234305
## 12      13    19 1.0819346 0.12577234        0.84955138        0.8836967
## 13      14    20 0.9369319 0.11446445        0.72610935        0.7569332
## 14      15    21 0.8194289 0.10759629        0.62222675        0.6508368
## 15      16    22 0.6908048 0.10185361        0.50575593        0.5322318
## 16      17    23 0.5894141 0.09962917        0.41054853        0.4356552
## 17      18    24 0.4989223 0.09978447        0.32287622        0.3468932
## 18      19    25 0.4726133 0.10842493        0.28454408        0.3094859
## 19      20    26 0.4173489 0.11575175        0.22222070        0.2468644
## 20      21    27 0.2976950 0.11251813        0.11968883        0.1397174
## 21      22    28 0.2400240 0.12001200        0.06539846        0.0819873
## 22      23    29 0.4577916 0.20473063        0.14864369        0.1803836
## 23      24    30 0.6754931 0.30208970        0.21933077        0.2661645
## 24      25    31 0.8634087 0.38612813        0.28034647        0.3402089
## 25      26    32 1.0040161 0.44900963        0.32600128        0.3956124
##    Quantile.0.25(R) Median(R) Quantile.0.75(R) Quantile.0.95(R)
## 1         1.4450409 1.7035760        1.9913034        2.4587051
## 2         1.4912437 1.7237672        1.9793230        2.3889590
## 3         1.3200764 1.5165981        1.7317432        2.0751554
## 4         1.2410779 1.4146324        1.6036767        1.9037817
## 5         1.2456665 1.4075603        1.5829216        1.8596155
## 6         1.4584617 1.6219838        1.7973033        2.0708249
## 7         1.5011409 1.6527615        1.8142694        2.0644270
## 8         1.4717611 1.6068598        1.7499876        1.9703253
## 9         1.3113322 1.4267674        1.5487891        1.7361602
## 10        1.2963053 1.4022002        1.5137131        1.6842118
## 11        1.1491285 1.2423543        1.3404928        1.4904848
## 12        0.9946576 1.0770650        1.1639048        1.2967845
## 13        0.8573989 0.9322747        1.0113898        1.1328180
## 14        0.7445208 0.8147244        0.8892107        1.0040700
## 15        0.6196538 0.6858055        0.7565087        0.8664328
## 16        0.5195124 0.5838103        0.6532111        0.7622912
## 17        0.4284953 0.4922860        0.5621219        0.6735931
## 18        0.3956839 0.4643482        0.5405441        0.6639414
## 19        0.3345762 0.4066978        0.4885320        0.6241796
## 20        0.2161545 0.2836454        0.3639732        0.5036317
## 21        0.1521344 0.2203457        0.3065963        0.4652659
## 22        0.3084234 0.4276606        0.5744764        0.8380808
## 23        0.4550933 0.6310334        0.8476669        1.2366278
## 24        0.5816958 0.8065807        1.0834797        1.5806457
## 25        0.6764258 0.9379335        1.2599258        1.8380560
##    Quantile.0.975(R)
## 1          2.6244959
## 2          2.5329479
## 3          2.1955178
## 4          2.0085685
## 5          1.9558194
## 6          2.1651730
## 7          2.1502729
## 8          2.0456070
## 9          1.8000616
## 10         1.7421780
## 11         1.5414648
## 12         1.3419870
## 13         1.1742159
## 14         1.0433607
## 15         0.9042566
## 16         0.8001144
## 17         0.7126626
## 18         0.7076205
## 19         0.6729457
## 20         0.5553914
## 21         0.5260890
## 22         0.9377027
## 23         1.3836245
## 24         1.7685354
## 25         2.0565439
## 
## $SIDistr
##   Mean Discrete SI Std Discrete SI
## 1            2.596        1.534531</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## estimate the instantaneous reproduction number (method &quot;ParametricSI&quot;) EstimateR(Flu2009$Incidence, T.Start=2:26, T.End=8:32, method=&quot;ParametricSI&quot;, Mean.SI=2.6, Std.SI=1.5, plot=TRUE) 

## estimate the instantaneous reproduction number (method &quot;UncertainSI&quot;) EstimateR(Flu2009$Incidence, T.Start=2:26, T.End=8:32, method=&quot;UncertainSI&quot;, Mean.SI=2.6, Std.Mean.SI=1, Min.Mean.SI=1, Max.Mean.SI=4.2, Std.SI=1.5, Std.Std.SI=0.5, Min.Std.SI=0.5, Max.Std.SI=2.5, n1=100, n2=100, plot=TRUE) </code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-infectious-dynamics-model-in-discrete-time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-temporal-multicomponent-model.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/Post/Method2.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
