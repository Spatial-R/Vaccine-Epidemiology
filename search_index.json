[
["index.html", "Vaccine Epidemiology Chapter 1 Background", " Vaccine Epidemiology Bing Zhang 2016-05-29 Chapter 1 Background This books includes some reading notes from the published books or papers, analysis method using real datasets and short insight on the vaccine epidemiology. You can download all the Rmd files in my Github. If you have any questions, just feel free to contact me (Email:zhangbing4502431@outlook.com). "],
["bayesian-infectious-dynamics-model-in-discrete-time.html", "Chapter 2 Bayesian Infectious Dynamics Model in Discrete Time 2.1 Introduction 2.2 Model and Parameters 2.3 Packages 2.4 Examples and Codes 2.5 Conclusion", " Chapter 2 Bayesian Infectious Dynamics Model in Discrete Time 2.1 Introduction Modeling the infectious disease dynamics can be done at individual level as well as population level, moreover, both provide an accurate description of the spread (progress) of infectious diseases in the coresponding situation. Individual-level model allows for the heterogeneity in a population via the individual covariates(Some packages:). While, when the analysis dataset is aggregated at the regular interval and information regarding individual movement and contact behavior is not available, model on population level is more suitable. Compartmental models are usually written using the ordinary differential equations and divide the population into serveral distinct compartments(categories) according to disease status, which is widely applied in the continuous times deterministic model previously (Cai et al. 2013). Majority of them are based on the assumption that all the individuals are equally likely to contact any other individuals in that population. Actually, when the size of compartments is large enough, the assumption of homogeneous mixing is indeed reasonal(appropriate). However, the situation at the most onset of epidemics is usually quite different, since most of the individuals in the population are susceptible and the number of infected is small. In addition, stochastic(demographical and environmental stochasticity) model based on a probability of disease contagion provide a more natural description of the transmission of infectious diseases, especially on those occasions where the data have been recorded over predetermined discrete time intervals(Allen 2014) (Corber\\a’an-Vallet and Santonja 2014). Consequently, we introduce two stochastic compartmental model in discrete time (Finkenstädt and Grenfell 2000) from the publised literatures as well as the analysis codes, aiming to provide a deeper insight into the underlying processes driving historical population dynamics. In spite of this, we also give serveral continuous times deterministic models and all of them can be found in Github. 2.2 Model and Parameters Firstly, let \\(y_{i}\\) denote the number of hopspitalization for the infectious disease reported at time \\(t( t \\in {1,2,3,..,T})\\).The time can be formulated as week, month or season. At the first level of the model hierarchy, we assume that the observations follow a binomial distribution: \\[ \\begin{aligned} y_{t} \\sim Bi(i_{t},\\rho) \\end{aligned} \\] where \\(i_{t}\\) is the number of new infectious at time \\(t\\) and \\(\\rho\\) is the probability of being hospitalized for the infectious disease, which also illustrates the correcting factor for geographical discrepancy. The number of newly infected individuals at time \\(t\\) can be modeled as \\[ \\begin{aligned} i_{t} \\sim Bi(S_{t-1},P_{t}) \\end{aligned} \\] where \\(S_{t-1}\\) is the susceptible population at time \\(t-1\\) and \\(P_{t}\\) is the probability of becoming infected at time \\(t\\). Here, you also can use the Possion distribution (Note: Which distribution to choose depends on the population you analysis. If the population is finite, the Binomial distribution is considered). For Susceptible-Infected(SI), SIR(Susceptible-Infected-Recovery), SIRS (Susceptible-Infected-Recovery-Susceptible), and so on, all the infectious models can use the bayesian method to obtain the posterior distribution of the model parameters. Here, we take the SIR model with constant population for example, and the number of susceptible,\\(S_{t}\\), infected, \\(I_{t}\\), and the recovery,\\(R_{t}\\) at time \\(t\\) are given the followed recursion equtions: \\[ \\begin{aligned} S_{t}=S_{t-1}-i_{t}+N*\\mu-\\mu*S_{t-1} \\\\\\\\ I_{t}=I_{t-1}-\\gamma*I_{t-1}+i_{t}-I_{t-1}*\\mu \\\\\\\\ R_{t}=R_{t-1}+\\gamma*I_{t-1}-R_{t-1}*\\mu \\\\\\\\ \\end{aligned} \\] where \\(\\mu\\) is the death rate and the birth rate,\\(\\gamma\\) is the proportion of infectious individuals that recover per unit time; N is the total population size. Finally, we need to model the parameter \\(P_{t}\\) in the second equation taking into consideration for the following condition. Firstly, this probability must lie in the interval 0-1.Secondly, \\(P_{t}\\) must considerate the transimissible nature of the infection and so dependence on the previous number of the infected individuals is advisable. This can be easily achieved by modeling the logit of \\(P_{t}\\), which is defined as \\(logit(P-{t})=log(\\frac{P_{t}}{(1-P_{t})})\\). In particular, we model the \\(logit(P_{t})\\) as : \\[ \\begin{aligned} logit(P-{t})=log(\\frac{P_{t}}{(1-P_{t})})=\\alpha*log(i_{t-1})+r_{t} \\end{aligned} \\] where the \\(exp{r_{t}}\\) represents the time-varing transmission rate and the mixing parameter \\(\\alpha\\) allows for heterogeneous mixing. Taking the mixing parameter \\(\\alpha=1\\) would correspond to the assumption of mass action. The equation aboved can also be writen as: \\[ \\begin{aligned} P_{t}=\\frac{i^{\\alpha}_{t-1}*exp(r_{t})}{(1+i^{\\alpha}_{t-1}*exp(r_{t}))}= (\\frac{i^{\\alpha}_{t-1}*exp(r_{t})}{(1+i^{\\alpha}_{t-1}*exp(r_{t}))}+c,1) \\end{aligned} \\] In order to account for the occurrrance of new cases after the disease has faded out, we add the paramter \\(c\\) to the model, which represents a constant probability of becoming infected. Fox example, the population can be infected by the individuals outside the population under study. The Uniform distribution in the interval (0,0.01) is assigned to parameter \\(c\\). The key feature of our model fformulation is the transimission rate, \\(exp(r_{t})\\), which is allowed to vary stochastically over time. Here, we present four alternative formulations of the SIR model in discrete time: Two stochastical formulation with different definations of transimmision rate and two deterministic formulations. Alternative 1: Stochastical model with a deterministic seasonal transimmision rate \\(exp(r_{t})\\), where: \\[ \\begin{aligned} r_{t}=r_{0}+\\sum\\limits_{k=1}^{K}(r_{2k-1}*sin(\\frac{2k*\\pi*t}{freq})+r_{2k}*cos(\\frac{2k*\\pi*t}{freq})) \\end{aligned} \\] The transimmision rate is allowed to vary over seasonally. However, there are no weekly random effects, the seasonal pattern repeats over time. Alternative 2: Stochastical model where the transimmision rate is assumed to be constant over time, where: \\[ \\begin{aligned} exp(r_{t})=exp(r) \\end{aligned} \\] Alternative 3: Deterministical model with a seasonal transimmision rate. Within the model formulation, the number of hospitalizations at time t is given by: \\[ \\begin{aligned} y_{t}=S_{t-1}*y_{t-1}*\\lambda _{t} \\end{aligned} \\] where \\(\\lambda_{t}\\), which is equivalent to the the paramter \\(exp(r_{t})\\), respresents the effective contact rate. Here we model the parameter \\(\\lambda_{t}\\) as: \\[ \\begin{aligned} \\lambda_{t}=r_{0}+\\sum\\limits_{k=1}^{K}(r_{2k-1}*sin(\\frac{2k*\\pi*t}{freq})+r_{2k}*cos(\\frac{2k*\\pi*t}{freq})) \\end{aligned} \\] Alternative 4: Deterministical model with a constant transimmision rate. This model is similar to the previous one with \\(\\lambda_{t}=\\lambda\\). The number of the hospitalizations at time \\(t\\) is \\(y_{t}=S_{t-1}*y_{t-1}*\\lambda\\). All the analysis codes can be found in the author’s website. Therefore, just try it! 2.3 Packages Here, i will introduce another R package to fit the TSIR model for infectious disease. You can install the tsiR package via devtools from the author’s Github. The method used in the package comes from the paper: Predictability in a highly stochastic system: final size of measles epidemics in small populations . Basic formula of analysis dataset consists five clolumns including time, cases,births, pop and IP(infectious period) can be created using the tsiRdata function. Other functions can be seen in the fellow part: Function Purpose estpars Using simple regression: reconstructs susceptibles and estimates parameters maxthreshold Using simple regression: optimizes the threshold parameter for sparse data mcmcestpars Using MCMC: reconstructions susceptibles and estimates parameters mcmctsir Using MCMC: reconstructions susceptibles, estimates parameters, and runs the simulation plotcases Plots just the cases data plotcomp Plots the data versus the simulations plotdata Plots the (interpolated) cases, births, and population time series plotres Plots the fitted regressions, reporting, susceptible reconstruction, estimated parameters, and the fit diagonstics runtsir Using simple regression: reconstructions suceptibles, estimates parameters, and runs the simulation simulatetsir Runs the simulation taking in the output from estpars or mcmcestpars tsiRdata Interpolates cases, births, and pop vectors to the generation time of the disease twentymeas Complete biweekly (IP=2) data sets from twenty UK cities Something need to be keep in mind is that the reconstruction for susceptible population in TSIR model is crutial. As the TSIR model assumes that all individuals will eventually become infected, the incidence must therefore track the number of births: \\[ \\begin{aligned} S_{t}=\\overline{S}+Z_{t} \\end{aligned} \\] \\[ \\begin{aligned} Z_{t+1}=\\sum\\limits_{i=1}^{t}(B_{i-d})-\\sum\\limits_{i=1}^{t}(\\rho_{i}*C_{i})+\\sum\\limits_{i=1}^{t}(\\mu_{i})+Z_{0} \\end{aligned} \\] Assuming \\(\\mu_{t}\\) is small, then \\(\\\\rho_{t}\\) can be estimated using local regression between the cummulative observed cases and the cummulative births with the \\(Z_{t}\\) as the residuals of the regreesion. How to use the function can be obtained form the code ?function_name. Serveral arguments should be treated cautiously, including IP(infectious period in weeks),alpha(maxing parameter, set 0.97), sbar(mean number of susceptibles, can be estimated from dataset), seasonality( can be one of “standard”, “schoolterm” or “none”), regtype(regression used in susceptible reconstruction. Options are “gaussian”“,”lm“(linear model),”spline“(smooth.spline with 2.5 degrees freedom),”lowess“(with f = 2/3, iter = 1),”loess“(degree 1), and”user&quot; which is just a user inputed vector), epidemics(whether to split the data up, two options: cont and break), threshold(cut off for a new epidemic if epidemics = “break”, can be fit by maximizing Rsquared predictions using the maxthreshold function, details can found (Caudron et al. 2014)). 2.4 Examples and Codes Actually, we can use the estpars and mcmcestpars function to get the estimate parameters, *maxthreshold function for the thresthod parameter, mcmctsir and mcmctsir** to run the simulations on MCMC and simple regression respectively. Here, we use the dataset in tsiR package to carry out a simple analysis and corresponding codes are: library(tsiR);require(kernlab) require(ggplot2);require(reshape2);require(grid) ## Loading required package: grid MoldMeas &lt;- twentymeas[[&quot;Mold&quot;]] parms &lt;- estpars(data=MoldMeas,alpha=0.97,IP=2) tau &lt;- maxthreshold(data=MoldMeas,parms=parms,IP=2) MoldRes &lt;- simulatetsir(data=MoldMeas,parms=parms,epidemics=&quot;break&quot;,threshold=tau,nsim=10,method=&quot;negbin&quot;) plotres(MoldRes) 2.5 Conclusion Utimately, TSIR model with stochastical effect from environment and demographics provides a knowledge on the dynamics of infectious diseases, while possible improvements include the use of statistical models such as trajectory matching or hidden Markov models to infer a biweekly incidence rate rather than using a linear interpolant is essential. Fortunately, Prof. Aaron A. King has established a pomp package, which provides a very general realization of nonliner partially-observed Markov processes model. I will give a short introduction about the analysis on Mumps dynamics using pomp package in the next chapter. References "],
["reproduction-numbers-during-epidemics.html", "Chapter 3 Reproduction numbers during epidemics 3.1 Basic reproduction number 3.2 Package R0 3.3 Package EpiEstim", " Chapter 3 Reproduction numbers during epidemics Reprouction number, R, is the number of secondary cases generated by a single individual over its entire infectious period in a complete susceptile population , which is commonly used to characterize pathogen transmissibility during a epidemic. The monitoring of R over time provides the feedback on the effectiveness of interventions. There are two R packages used to measure the reproduction number: R0 and EpiEstim. The former package can calculate the basic reproduction number(R0) and the time-varing reproduction number(Rt), however, the latter package supplies a new framework to estimate the time-vary reproduction number. There are two papers which give the detail introduction to the packages,respectively and you can download them in here and here. 3.1 Basic reproduction number The concept of reproduction number is firstly introduced by the work of Alfred Lotka and Ronald Ross (PS: He received the Nobel Prize for Physiology or Medicine in 1902). However,the first modern application to the basic reproduction number in epidemiology was George MacDonald in 1952, who constructed population models on malaria. The R0 is a nonnegative value, if above 1 indicate that the disease will spread among a population, however, on the contrary, the infection will be die in the future. But some literatures also emphasized that even when the R0 below one it can be transimitted during a long-distance flights. A review of generic methods used to estimate transmissibility parameters during outbreaks was carried out. Most methods used the epidemic curve and the generation time distribution (Note: The generation time reflect the time lag between infection in a primary case and a secondary case). Overall, the epidemic curve can be finished by the surveillance data by the epicurve function in epitoolspackage, however, the time distribution should be obtained from the time lag between all infectee/infector pairs and can’t be observed directly. Therefore, the serial interval distribution comes! 3.2 Package R0 As aformentioned, the value of generation time was substituted with the serial interval distribution. In R0 package, the generation.time function can creat a discretized generation time distribution, which based on the tiem interval to choose. Two types of distribution can be used: Emperical distribution and Parametric distribution. The former requires the full specification of the distribution, however, the latter includes thress methods (gamma, lognormal and weibull distribution) and need the mean and standard deviation information. Aterlatively, you can use the maximum likelihood method on the observed time intervals between the symptom onsets in primary cases and secondary cases. The est.GT function do solve the process. The package R0 includes five methods to calculate the basic reproduction number(also called initial number) and the time varying reproduction number:Attack Rate (AR), Exponential Growth (EG), Maximum Likelihood (ML),Time-Dependant (TD), and Sequential Bayesian (SB). A detailed description to the method aboved can be found here. Here, we just point out the difference among the five methods: Attack Rate (AR): Background: Origined from the classical suspective-infective-recoery model. Attack rate is the percentage of population eventually infected. Assumption: homogeneous mixing and closed population, No intervention. Exponential growth (EG): Background: Phenomenon about the exponential growth rate rate during the early phase of an outbreak. Assumption: The growth rate of the study period in epidemic curve is expential( deviance based R-squared statistic guide the choose). Maximum Likelihood (ML): Background: Phenomenon about the exponential growth rate rate during the early phase of an outbreak. Assumption: The secondary cases caused by an index case is Possion distribution with the excepted value of R. Moreover,the growth rate of study period in epidemic curve (from the first case on) is expential (Deviance based R-squared statistic guide the choose). Time-Dependant (TD): Background: A time-dependant method to compute the reproduction number by averaging over all the transmission networks compatible with observations. Assumption: It is possible to account for the importation cases during the epidemic. The confidence interval for Rt can be obtained by simulation. Sequential Bayesian (SB): Background: Sequential bayesian estimation for the initial reproduction number. Origined from the approximation to tehe classical suspective-infective-recoery model with Possion distribution. Assumption: Epidemic with a period of exponential growth and random mixing in the population. The estimate.R function can realize the aformentioned methods by the “method” arguement. Overall, the exponential growth method (ML and TD) performance was the least affacted by the either aggregation or the over dispersion. 3.2.1 Example and code Here, we used the dataset from the 1918 influenza pandemic and you can see its structure by the code “demo(Germany.1918)”. For simlicity, the example code only fixed on the Maximum Likelihood method. Overall, three steps to calculate the reproduction number: generate time distribution, estimate, and sensitively analysis. Analysis codes are as followed: library(R0);options(device = &quot;options&quot;);data(Germany.1918) epid = c(&quot;2012-01-01&quot;, &quot;2012-01-02&quot;, &quot;2012-01-02&quot;,&quot;2012-01-03&quot;) epid.count = c(1,2,4,8) GT.flu&lt;-generation.time(&quot;gamma&quot;, c(2.6,1)) res.R &lt;- estimate.R(Germany.1918, GT=GT.flu,methods=c(&quot;ML&quot;)) plotfit(res.R) ################ senzitively analysis ################## sensitivity.analysis(Germany.1918, GT.type=&quot;gamma&quot;,GT.mean=seq(1,5,1), GT.sd.range=1, begin=1, end=27,est.method=&quot;EG&quot;, sa.type=&quot;GT&quot;) ## GT.Type GT.Mean GT.SD R ## [1,] &quot;gamma&quot; &quot;1.58086588154581&quot; &quot;0.954292896527714&quot; &quot;1.28838902705086&quot; ## [2,] &quot;gamma&quot; &quot;2.04095089518824&quot; &quot;1.00627238027527&quot; &quot;1.36339301322812&quot; ## [3,] &quot;gamma&quot; &quot;2.99986217575755&quot; &quot;1.03970173174022&quot; &quot;1.53635327348974&quot; ## [4,] &quot;gamma&quot; &quot;3.99988819553508&quot; &quot;1.0405125530655&quot; &quot;1.74123683125572&quot; ## [5,] &quot;gamma&quot; &quot;4.99994770859945&quot; &quot;1.04068406516072&quot; &quot;1.97350896139042&quot; ## CI.lower CI.upper ## [1,] &quot;1.27247564304064&quot; &quot;1.3046931144676&quot; ## [2,] &quot;1.34280441223374&quot; &quot;1.38454612273489&quot; ## [3,] &quot;1.5041427715636&quot; &quot;1.56966342209184&quot; ## [4,] &quot;1.6940358887725&quot; &quot;1.79038129320771&quot; ## [5,] &quot;1.90795871942726&quot; &quot;2.04221224170092&quot; 3.3 Package EpiEstim Most methdology to the reproduction number require the incidence data and the distribution of series interval. However, the estimate is right censored for the estimate of Rt requires the incidence data after time t. Moreover, some methods are sensitive to the selected time step or smoothing parameters. Anne Cori proposed a new framework and software[EpiEstim] to estimate the time-varying reproduction number. In the EpiEstim package, the time-varying reproduction number was divided into two types: Rt and Rtc. Here, we call Rt the instaneous reproduction number and call the Rtc the case reproduction number. The distinction between the Rtc and Rt is on the observation perspective: one is measured retrospectively, however,another is prospective based on the assumption that the infectious situation is constant in the future. In practice, we assume that the infectious probability distribution ws of individual infected, depend on the individual biological factors such as symptom severity. Therefore, the infectious profile lie on the ws and the time since infection of the case, but indepent of the calendar time. Generaly, Rt can be estimate by the multiplication on the ratio of the number of new infectious cases at time t-1 and the ws. Rtc also called the cohort reproduction number becasue it counts the average number of secondary casued by a cohort infected at time t. Comparatively speaking, Rtc is more suitable for the situation that the contact rate and transmissibility can change over time, especially when the control measures are initiated. However, the correspending methods to the Rtc is inavailiable in EpiEstim package . The EpiEstim package includes three types of methods to estimate the Rt: NonParametricSI， ParametricSI, and UncertainSI. The detained description to the method aboved can be foound here.All the method can be applied by the EstimateR function. For method “NonParametricSI”, the discrete distribution of the serial interval is directly speciﬁed in the argument “SI.Distr”; For method “ParametricSI”, the mean and standard deviation of the continuous distribution of the serial interval are given in the arguments “Mean.SI”&quot; and “Std.SI”, which is derived automatically using “DiscrSI”; For method “UncertainSI”, mean and standard deviation of the serial interval vary according to truncated normal distributions.Firstly, we sample the mean from its truncated normal distribution(with mean Mean.SI,standard deviation Std.Mean.SI, minimum Min.Mean.SI and maximum Max.Mean.SI). Then,we sample the standard deviation from its truncated normal distribution (with mean Std.SI, standard deviation Std.Std.SI, minimum Min.Std.SI and maximum Max.Std.SI). 3.3.1 Example and code Here, we use the dataset about the pendemic influenza in a school in Pennsylvania, 2009. You can see the structure of the dataset by the code “demo(Flu2009)”. Due the article length, we just give the result of the method “NonParametricSI”. The analysis code is as followed: library(EpiEstim) data(&quot;Flu2009&quot;) ## estimate the instantaneous reproduction number (method &quot;NonParametricSI&quot;) EstimateR(Flu2009$Incidence, T.Start=2:26, T.End=8:32, method=&quot;NonParametricSI&quot;, SI.Distr=Flu2009$SI.Distr, plot=TRUE, leg.pos=xy.coords(1,3)) ## $R ## T.Start T.End Mean(R) Std(R) Quantile.0.025(R) Quantile.0.05(R) ## 1 2 8 1.7356089 0.40908694 1.02863184 1.1218113 ## 2 3 9 1.7490494 0.36470202 1.10874730 1.1953991 ## 3 4 10 1.5370427 0.30740855 0.99469301 1.0686828 ## 4 5 11 1.4316392 0.27055438 0.95131387 1.0175191 ## 5 6 12 1.4223487 0.25143809 0.97288543 1.0355344 ## 6 7 13 1.6349410 0.25227688 1.17832168 1.2432610 ## 7 8 14 1.6636221 0.23295369 1.23867595 1.2998676 ## 8 9 15 1.6156800 0.20686663 1.23586721 1.2911239 ## 9 10 16 1.4340033 0.17651360 1.10905802 1.1565305 ## 10 11 17 1.4083724 0.16155139 1.10963727 1.1535884 ## 11 12 18 1.2477516 0.14219449 0.98470606 1.0234305 ## 12 13 19 1.0819346 0.12577234 0.84955138 0.8836967 ## 13 14 20 0.9369319 0.11446445 0.72610935 0.7569332 ## 14 15 21 0.8194289 0.10759629 0.62222675 0.6508368 ## 15 16 22 0.6908048 0.10185361 0.50575593 0.5322318 ## 16 17 23 0.5894141 0.09962917 0.41054853 0.4356552 ## 17 18 24 0.4989223 0.09978447 0.32287622 0.3468932 ## 18 19 25 0.4726133 0.10842493 0.28454408 0.3094859 ## 19 20 26 0.4173489 0.11575175 0.22222070 0.2468644 ## 20 21 27 0.2976950 0.11251813 0.11968883 0.1397174 ## 21 22 28 0.2400240 0.12001200 0.06539846 0.0819873 ## 22 23 29 0.4577916 0.20473063 0.14864369 0.1803836 ## 23 24 30 0.6754931 0.30208970 0.21933077 0.2661645 ## 24 25 31 0.8634087 0.38612813 0.28034647 0.3402089 ## 25 26 32 1.0040161 0.44900963 0.32600128 0.3956124 ## Quantile.0.25(R) Median(R) Quantile.0.75(R) Quantile.0.95(R) ## 1 1.4450409 1.7035760 1.9913034 2.4587051 ## 2 1.4912437 1.7237672 1.9793230 2.3889590 ## 3 1.3200764 1.5165981 1.7317432 2.0751554 ## 4 1.2410779 1.4146324 1.6036767 1.9037817 ## 5 1.2456665 1.4075603 1.5829216 1.8596155 ## 6 1.4584617 1.6219838 1.7973033 2.0708249 ## 7 1.5011409 1.6527615 1.8142694 2.0644270 ## 8 1.4717611 1.6068598 1.7499876 1.9703253 ## 9 1.3113322 1.4267674 1.5487891 1.7361602 ## 10 1.2963053 1.4022002 1.5137131 1.6842118 ## 11 1.1491285 1.2423543 1.3404928 1.4904848 ## 12 0.9946576 1.0770650 1.1639048 1.2967845 ## 13 0.8573989 0.9322747 1.0113898 1.1328180 ## 14 0.7445208 0.8147244 0.8892107 1.0040700 ## 15 0.6196538 0.6858055 0.7565087 0.8664328 ## 16 0.5195124 0.5838103 0.6532111 0.7622912 ## 17 0.4284953 0.4922860 0.5621219 0.6735931 ## 18 0.3956839 0.4643482 0.5405441 0.6639414 ## 19 0.3345762 0.4066978 0.4885320 0.6241796 ## 20 0.2161545 0.2836454 0.3639732 0.5036317 ## 21 0.1521344 0.2203457 0.3065963 0.4652659 ## 22 0.3084234 0.4276606 0.5744764 0.8380808 ## 23 0.4550933 0.6310334 0.8476669 1.2366278 ## 24 0.5816958 0.8065807 1.0834797 1.5806457 ## 25 0.6764258 0.9379335 1.2599258 1.8380560 ## Quantile.0.975(R) ## 1 2.6244959 ## 2 2.5329479 ## 3 2.1955178 ## 4 2.0085685 ## 5 1.9558194 ## 6 2.1651730 ## 7 2.1502729 ## 8 2.0456070 ## 9 1.8000616 ## 10 1.7421780 ## 11 1.5414648 ## 12 1.3419870 ## 13 1.1742159 ## 14 1.0433607 ## 15 0.9042566 ## 16 0.8001144 ## 17 0.7126626 ## 18 0.7076205 ## 19 0.6729457 ## 20 0.5553914 ## 21 0.5260890 ## 22 0.9377027 ## 23 1.3836245 ## 24 1.7685354 ## 25 2.0565439 ## ## $SIDistr ## Mean Discrete SI Std Discrete SI ## 1 2.596 1.534531 ## estimate the instantaneous reproduction number (method &quot;ParametricSI&quot;) EstimateR(Flu2009$Incidence, T.Start=2:26, T.End=8:32, method=&quot;ParametricSI&quot;, Mean.SI=2.6, Std.SI=1.5, plot=TRUE) ## estimate the instantaneous reproduction number (method &quot;UncertainSI&quot;) EstimateR(Flu2009$Incidence, T.Start=2:26, T.End=8:32, method=&quot;UncertainSI&quot;, Mean.SI=2.6, Std.Mean.SI=1, Min.Mean.SI=1, Max.Mean.SI=4.2, Std.SI=1.5, Std.Std.SI=0.5, Min.Std.SI=0.5, Max.Std.SI=2.5, n1=100, n2=100, plot=TRUE) "],
["spatial-temporal-multicomponent-model.html", "Chapter 4 Spatial-temporal Multicomponent Model 4.1 模型综述 4.2 模型优点 4.3 具体实例 4.4 结语", " Chapter 4 Spatial-temporal Multicomponent Model Welocome to the surveillance project again! 这是一篇针对Surveillance程序包中时空多成分模型( Spatial-temporal Multicomponent Model)的文章。时空多成分模型是surveillance程序包提供的四大分析模块之一(Outbreaks detection, Endemic-epidemic Spatio-temporal Point Process Intensity Model, SIR event history of a fixed population 和 Spatial-temporal Multicomponent Model)，自去年10月份开始接触，期间走了很多弯路(学习过程)，故将相关教训在此文中分享，希望对时空流行病学感兴趣的朋友能够尽快熟悉该模型并能应用于自己的数据。英文功底不错的建议阅读该程序包的英文说明文档。 4.1 模型综述 时空多成分模型(Spatial-temporal Multicomponent Model)的简约版最初由Held et al. (2005)提出，并应用于麻疹疫情中[PS: 基于浙江省麻疹疫情已写了篇类似的文章，已投中华流行病学杂志]。Leonhard Held et al.(2006)在“A two-componet model for counts of infectious disease”一文中构建了随机双成分(相互独立)模型，包括局部特性成分(Endemic Component)和时间流行成分(Epidemic Component)，其中局部特性成分控制季节效应的影响，时间流行成分同时考虑了疾病疫情的时间相关性和暴发影响。该模型假设时序数据服从Generalised Branching Process with Immigration， 分别对甲肝和乙肝进行了拟合。在surveillance程序包中，基础模型中将时序数据分为三个成分：局部特性成分(Endemic component, end)、时间自相关成分(Autoregressive component，ar)和空间流行成分(Epidemic component, ne)，并在公式中分别用\\(ν_(i,t)\\)、\\(λ_(i,t)\\)和\\(ϕ_(i,t)\\)表示。其中局部特性成分反映疫情的本地风险情况，时间自相关成分反映的是过去时段疫情在时间维度上产生的影响，而空间流行成分反映的是邻近单元对目标单元产生的影响(可根据多种空间权重矩阵来定义邻近)。具体的公式如下： \\(γ_0\\)、\\(α_0\\) 和 \\(β_0\\)分别代表了三成分的截距，\\(γ_i\\)、\\(α_i\\) 和 \\(β_i\\) 分别代表三成分的随机效应，都服从均值为0的正态分布；γ、α 和 β分别代表了协变量 \\(z_(i,t)^T\\)、\\(μ_(i,t)^T\\) 和 \\(x_(i,t)^T\\) 对局部特性成分、时间自相关成分和空间流行成分的作用强度。其中协变量\\(z_(i,t)^T\\)在本研究中包含了季节效应\\({∑_(s=1)^S[κ_s sina(τ_s t)+δ_s cosa(τ_s t)]}\\)，其中S代表周期数，\\(τ_s=2πs/freq\\)。 4.2 模型优点 surveillance程序包中的时空多成分模型相关优点主要体现在如下几个方面： 空间权重：多种方式定义研究单元的邻近性 协变量纳入：自变量反映局部和时序关系 随机效应：考虑区域的空间异质性 空间权重对空间分析影响较大，其设置方式是空间分析中老生常谈的话题。surveillance程序包除提高基本的空间权重矩阵外(如一阶queen邻近等，具体见spdep程序包)，还提供Power-law算法，能更好模拟传染病远距离传播的特性(在一定距离范围内快速递减)。 协变量纳入不仅可在控制其他效应后准确度量协变量和结局变量之间的关系，也能较高地提高模型拟合度(AIC)。协变量一般纳入局部特性成分或时间自相关成分，借以反映其在局部疫情风险和时序效果上的影响，当然，将协变量得系数恒设为1进而转变成offset。不管何种方式，都可以借助AIC值来选择最优拟合模型，尽管有研究表明将易感人群比例值纳入时间自相关成分效果较佳(见此文)。 在协变量不能完全反映研究单元的空间异质性时，随机效应能显著提高模型的预测精度。时空多成分模型中纳入随机效应最初由M. Paul and Held L(2010)提出，这极大提高了时空多成分模型的适用度。对于来自大疫情的传染病监测数据，无法观测的空间异质性主要体现在underreporting。而针对不同研究单元不同成分随机效应的可视化，可为卫生决策者提供较好的干预方向，若某区域麻疹的局部特性成分较大，则说明麻疹疫情的本地风险较大，进一步巩固本地免疫屏障则显得尤为重要。 4.3 具体实例 4.3.1 STS数据 surveillance程序包中提供hhh4函数来拟合时空多成分模型，其所需的数据格式为sts(surveillance time series)。sts数据需包括以下几个部分：疫情数据，人口数据，空间邻阶数据,地图数据或和协变量数据。可借助new函数生成sts数据，示例代码如下： measlesWeserEms &lt;- new(&quot;sts&quot;, start = c(2013, 1), freq =365, epoch = 1:nrow(dat.final), observed = dat.final, neighbourhood = weserems_nbOrder, map = dat.zj, populationFrac = populationFrac) 此处，我的数据是逐日数据，因而freq设置为365，dat,final是疫情数据，dat.zj是地图数据，populationFrac是人口比例数据(研究单元人口占总研究单元人口数的百分比)。此处一定需注意各个数据集之间匹配问题，也就是变量名一定要一致(重要的事情不说三遍!!!)。对于空间邻阶文件，可通过spdep程序包中的poly2adjmat和nbOrder函数来生成，但需注意孤立区域，如浙江省的洞头县尽管从地图属性是孤立的，但考虑传染病的扩散特性，还是将其设置为与乐清市相邻。 4.3.2 数据可视化 对于sts数据，surveillance程序包提供了一系列简约的方式来进行数据可视化(时间和空间)。考虑到数据保密性，此处，仅利用程序包自带的measlesWeserEms数据集来实现数据可视化和模型拟合。时间序列可视化的部分代码如下： measlesWeserEms15 &lt;- measlesWeserEms[, colSums(observed(measlesWeserEms)) &gt; 6] plot(measlesWeserEms15, type =observed ~ time | unit, legend.opts = NULL) 你可以调节type参数的值，如“observed ~ time”或“observed ~ unit”等来达到不同的可视化效果，需要注意的是其采用的是spplot和lattice绘图系统，若想调节图形相关参数的可查阅程序包的帮助文档。当然，也可以用ggplot2和gridExtra程序包，分别实现数据可视化和图形组合(推荐之至)。 4.3.3 模型拟合 此处先拟合基础模型，其包括三成分，其中各研究单元的人口比例值作为offset结合地域面积来反映人口密度，局部特性成分控制季节效应，时间流行成分和空间流行成分(一阶邻近)都只包括截距项。为控制研究区域疫情的过度离散特性，采用负二项分布(NegBin1)进行拟合，当然也可以选择p泊松分布(Possion)。相关代码如下： library(surveillance) measlesModel_basic &lt;- list( end = list(f = addSeason2formula(~1 + t, period = measlesWeserEms@freq),offset = population(measlesWeserEms)), ar = list(f = ~1),ne = list(f = ~1, weights = neighbourhood(measlesWeserEms) == 1), family = &quot;NegBin1&quot;) measlesFit_basic &lt;- hhh4(stsObj = measlesWeserEms, control = measlesModel_basic) summary(measlesFit_basic, idx2Exp = 1:4, amplitudeShift = TRUE, maxEV = TRUE) ## ## Call: ## hhh4(stsObj = measlesWeserEms, control = measlesModel_basic) ## ## Coefficients: ## Estimate Std. Error ## exp(ar.1) 0.645403 0.079270 ## exp(ne.1) 0.015805 0.004200 ## exp(end.1) 1.080248 0.278839 ## exp(end.t) 1.001185 0.004264 ## end.A(2 * pi * t/52) 1.164231 0.192124 ## end.s(2 * pi * t/52) -0.634360 0.133500 ## overdisp 2.013839 0.285441 ## ## Epidemic dominant eigenvalue: 0.72 ## ## Log-likelihood: -971.72 ## AIC: 1957.44 ## BIC: 1995.72 ## ## Number of units: 17 ## Number of time points: 103 summary函数中idx2Exp是一个简单系数转换参数，此处是将系数中的ar.1，ne.1，end.1和end.t转换成其对数值，至于为什么要转换，看看基础模型的公式即可知。Epidemic dominant eigenvalue表示疾病发病率中空间流行成分百分值，更进一步的可视化形式如下: districts2plot &lt;- names(which(colSums(observed(measlesWeserEms)) &gt; 20)) plot(measlesFit_basic, type = &quot;fitted&quot;, units = districts2plot, hide0s = TRUE) 对于上图的解读可以从如下方面进行：三种颜色条纹分别代表局部特性成分、时间自相关成分和空间流行成分(需注意的是，此图中作者将Epidemic理解成spatiotemporal，似乎也是有一定道理)。总体而言，这六个研究单元的麻疹疫情主要是受先前麻疹疫情的影响，麻疹疫情出现后，没及时发现并及时进行相应处理。区域单元03453在2002年上半年疫情受邻近区域的影响较大。 4.3.4 纳入协变量 对于疫苗针对传染病而言，相关疫苗覆盖率对传染病疫情的传播具有重要影响。因此，此处易感人群比例作为协变量纳入基础模型，至于纳入何种成分中，且看AIC值。相关代码如下： Sprop &lt;- matrix(1 - measlesWeserEms@map@data$vacc1.2004, byrow = TRUE, nrow = nrow(measlesWeserEms), ncol = ncol(measlesWeserEms)) Soptions &lt;- c(&quot;unchanged&quot;, &quot;Soffset&quot;, &quot;Scovar&quot;) SmodelGrid &lt;- expand.grid(end = Soptions, ar = Soptions) row.names(SmodelGrid) &lt;- do.call(&quot;paste&quot;, c(SmodelGrid, list(sep = &quot;|&quot;))) measlesFits_vacc &lt;- apply(X = SmodelGrid, MARGIN = 1, FUN = function (options) { updatecomp &lt;- function (comp, option) switch(option, &quot;unchanged&quot; = list(), &quot;Soffset&quot; = list(offset = comp$offset * Sprop), &quot;Scovar&quot; = list(f = update(comp$f, ~. + log(Sprop)))) update(measlesFit_basic, end = updatecomp(measlesFit_basic$control$end, options[1]), ar = updatecomp(measlesFit_basic$control$ar, options[2]), data = list(Sprop = Sprop)) }) AIC.list &lt;- function (object, ..., k = 2){ if (is.null(names(object))) stop(&quot;the list of models must have names&quot;) eval(as.call(c(lapply(c(&quot;AIC&quot;, names(object)), as.name), list(k = k))), envir = object) } aics_vacc &lt;- AIC(measlesFits_vacc);aics_vacc[order(aics_vacc[, &quot;AIC&quot;]), ] ## df AIC ## `Scovar|unchanged` 8 1917.071 ## `Scovar|Scovar` 9 1919.070 ## `Soffset|unchanged` 7 1922.114 ## `Soffset|Scovar` 8 1924.020 ## `Scovar|Soffset` 8 1934.478 ## `Soffset|Soffset` 7 1936.990 ## unchanged|unchanged 7 1957.442 ## `unchanged|Scovar` 8 1958.959 ## `unchanged|Soffset` 7 1966.933 由AIC值可知，当易感人群比例这个变量纳入局部特性成分时模拟拟合度最好，这个也很好理解，本地免疫屏障影响着麻疹疫情的本地风险水平。当然，选择模型时候仍需结合专业知识。 4.3.5 Power-law 在基础模型中，我们假定麻疹疫情只会在具有共同边际的研究单元间传播，且传播系数都一致。考虑到人群的流动性，基础模型明显具有局限性。结合相关协变量，我们同时考虑研究区域的人口百分比(人越多，远距离传播的可能性就越大)和多阶传播(多阶相邻和Power-law)。相关代码如下： measlesFit_vacc &lt;- measlesFits_vacc[[&quot;Scovar|unchanged&quot;]] measlesFit_nepop &lt;- update(measlesFit_vacc, ne = list(f = ~log(pop)), data = list(pop = population(measlesWeserEms))) measlesFit_np2 &lt;- update(measlesFit_nepop, ne = list(weights = W_np(maxlag = 2))) measlesFit_powerlaw &lt;- update(measlesFit_nepop, ne = list(weights = W_powerlaw(maxlag = 5))) summary(measlesFit_powerlaw, idx2Exp = 1:5, amplitudeShift = TRUE, maxEV = TRUE) ## ## Call: ## hhh4(stsObj = object$stsObj, control = control) ## ## Coefficients: ## Estimate Std. Error ## exp(ar.1) 0.59314 0.06982 ## exp(ne.1) 44.52223 55.10724 ## exp(ne.log(pop)) 9.89295 4.96028 ## exp(end.1) 474.78153 406.32394 ## exp(end.t) 1.00383 0.00440 ## end.A(2 * pi * t/52) 1.10678 0.19405 ## end.s(2 * pi * t/52) -0.43513 0.15135 ## end.log(Sprop) 2.32578 0.32256 ## neweights.d 4.10214 1.05496 ## overdisp 1.60779 0.23055 ## ## Epidemic dominant eigenvalue: 0.77 ## ## Log-likelihood: -931.03 ## AIC: 1882.06 ## BIC: 1936.74 ## ## Number of units: 17 ## Number of time points: 103 通过定义不同形式的空间权重矩阵，可较好地度量传染病的空间蔓延规律，尤其是在人口流动或是交通数据缺乏的情况下。 当然，如果你有相关数据，直接修改weights参数即可。 4.3.6 Random effect 对于政府决策者，不仅要知道整个研究区域内传染病的时空传播特性，还需要知晓其在区域间的传播异质性，以便采取相应措施来防控传染病。另一方面，很多影响传染病传播的因素较难度量，而随机效应则是解决这类不确定问题的利器。我们在power-law模型的基础上构建三个成分的随机效应，具体代码如下： measlesFit_ri &lt;- update(measlesFit_powerlaw, end = list(f = update(formula(measlesFit_powerlaw)$end, ~ . + ri() - 1)), ar = list(f = update(formula(measlesFit_powerlaw)$ar, ~ . + ri() - 1)), ne = list(f = update(formula(measlesFit_powerlaw)$ne, ~ . + ri() - 1))) ## [1] &quot;false convergence (8)&quot; ## Update of variance parameters in iteration 5 unreliable head(ranef(measlesFit_ri, tomatrix = TRUE)) ## ar.ri(iid) ne.ri(iid) end.ri(iid) ## 03401 0.0000000 -0.05673057 -1.0044596 ## 03402 1.2234776 0.04311721 1.5263983 ## 03403 -0.8272548 1.55877779 -0.6198755 ## 03404 -0.3772432 -0.50126451 -1.1188042 ## 03405 0.0000000 -0.09105187 -1.2822860 ## 03451 -0.5241670 -0.11345751 0.4959956 for (comp in c(&quot;end&quot;,&quot;ar&quot;, &quot;ne&quot;)) { print(plot(measlesFit_ri, type = &quot;ri&quot;, component = comp, xlim = c(6.6,8.8), labels = list(cex = 0.6), at = seq(-1.7, 1.7, length.out = 15))) } 通过这三图分别代表局部特性成分、时间自相关成分和空间流行成分的随机效应，可知03460和03457区域的局部特性成分较大，03454和03457区域的时间自相关成分较大，0.453和03452的空间流行成分较大，故相应措施应运而生：针对03460和03457区域，需加强本地麻疹免疫屏障建设来降低麻疹的本地风险；针对03454和03457区域，则需加强麻疹疫情的应急处置工作，及时控制疫情发展；针对0.453和03452区域则需控制其周边区域麻疹疫情对目标区域的影响。 4.4 结语 本文比较粗糙地介绍了时空多成分模型在R中的实现步骤及相关注意事项，当然，你还可以对模型进行扩展。接下来打算基于shiny来开发时空多成分模型的app，也是作为大疫情数据分析平台的一部分。 "],
["vaccine-epidemiology-a-short-insight.html", "Chapter 5 Vaccine Epidemiology: A short insight 5.1 Background 5.2 Introduction 5.3 Vaccine Epdemiology 5.4 Conclusion", " Chapter 5 Vaccine Epidemiology: A short insight What is right to be done cannot be done too soon! 5.1 Background This is a short insight into the vaccine epidemiology after working in the department of immunization program of Zhejiang provincial center for disease control and protection for nearly two years. The reason to write this blog is to sum up the knowledge on the vaccination research program and extract some useful ideas or clues to do the further investigations into the vaccine epidemiology. Here, I have just simply defined the vaccine epidemiology as all the epidemiology issues related to both the vaccine and infectious diseases. Fox instance, decision makers may have great interests to investigate how the efficiency of certain vaccine on infectious disease or test whether there is a cross-protection for other types of vires in the clinic trials or not. Compared to the traditional epidemiology, vaccine epidemiology has focused more on the vaccine than the disease. As my primary interest is about the resparitory disease, many analysis methods talk about in the following sections may not be sutable for the vector-borne or other types of infectious diseases. 5.2 Introduction Infectious diseases, also called communicable disease, are caused by pathogenic microorganisms, such as bacteria, viruses, parasites or fungi; the diseases can be spread, directly or indirectly, from one person to another. Vaccination is the administration of antigenic material (a vaccine) to stimulate an individual’s immune system to develop adaptive immunity to a pathogen, which is the most powerful and cost-effective way to prevente the infectious disease (Meireles 2015). Generally speaking, a vaccine typically contains an intact but inactivated (non-infective) or attenuated (with reduced infectivity) forms of the pathogensagent that resembles a disease-causing micro-organism and primes the immune system (“Vaccine - Wikipedia, the Free Encyclopedia” 2016). Acoording to the report of World Health Organization, the licensed vaccines are currently available to prevent or contribute to the prevention and control of twenty-five preventable infections. Epidemiology is the study and analysis of the patterns, causes, and effects of health and disease conditions in defined populations. It is the cornerstone of public health, and shapes policy decisions and evidence-based practice by identifying risk factors for disease and targets for preventive healthcare (“Epidemiology - Wikipedia, the Free Encyclopedia” 2016). As we emphasized particularly on infectious diseases, it is important to understand three essential elements to the infectious disease: source of infection(host), route of transmission(including droplet contact, Fecal-oral transmission, Sexual transmission, Oral transmission, Transmission by direct contact, Vertical transmission, Iatrogenic transmission, and Vector-borne transmission) and susceptible population(population with no immunity against pathogens). Therefore, the priority in vaccine epidemiology is to explore the effect of vaccine on the distribution of host and susceptible population, as well as the impact on the transmissibility. Despite this obvious progress and the established programs, some vaccine-preventable diseases have re-emerged worldwide, such as pertussis and measles (Wicker and Maltezou 2014). Moreover, numerous large-scale Mumps and vericella outbreaks have occurred in the vaccinated populations with high vaccination coverage(Rubin et al. 2011). Thus, deep insight into the vaccine epidemiology to sustain the achivement on the widespread immunity and take targeted vaccine-related prophylatical measures to infectious disease is neccessary. 5.3 Vaccine Epdemiology 5.3.1 Vaccine-related Items Before we talk about the vaccine epidemiology, we should figure out three definitions of vaccine related items: vaccine efficiency, vaccine effectiveness and vaccine impact. Vaccine efficacy is commonly defined as the direct effect of a vaccine measured in pre-licensure randomized clinical trials, where vaccination is allocated under optimal conditions. Vaccine (direct) effectiveness is estimated by comparing vaccinated and unvaccinated individuals exposed to the same vaccination programme in the observational post-licensure studies(case-control and cohort study from the same population). The impact of a vaccination programme, defined here as the population prevented fraction when exposure is the programme, is measured by comparing populations with and without a vaccination programme, most commonly the same population before and after vaccination or the cluster randomized trials (Hanquet et al. 2013). 5.3.2 Vaccine Strategies The common interventions related to the infectious disease include vaccination, screening(allows the infected individuals to be treated before they progress to be more server disease and /or infect other individuals), social distancing(isolation of susceptible individuals, school closure, travel restriction and cancellation of mass gathering such as football matchs), post-exposure treatment(chemotreament opinons such as antimicrobials can be dealt with static models). A optimal vaccination strategy need take the following situation into consideration to maximize the health impact and minimize the logistical barries: vaccine supplies, vaccination time, and vaccination situation with nonvccine-related factors changed. Situation in the vaccine supply can be divided into two type: limited vaccine supply or full vaccine supply. The vaccination time is focused on the time when to carry out the vaccination program. Use of the vaccine prior to the outbreak is considered as preemptive vaccination, while the vaccination after the outbreak begins is referred to as the reactive vaccination (Boettiger and Hastings 2013). How to allocate the limited vaccine in the reactive vaccination compaign is complicated but valuable. Moreover, it is also needed pay great attention to the delay time in reactive vaccination campaigns. Previous publications have found that vaccination delay time in a outbreak setting also shape the performance of different vaccine strategies (A. S. Azman and Lessler 2014). In contrast to regularly vaccination compaigns, ractive campaigns are often subjected to limited vaccine, and logistical delay forcing vaccinations to make difficult allocation decisions. Some infectious diseases, especially for the respiratory and vector-borne infectious diseases were deeply influenced by other nonvccine-related factors such as the meteorological factors(the temperature and relative humility) and air pollution(particle matter, O3 and NO2)(Cowling et al. 2013) (Passos et al. 2014). Some literatures have reported that the combination of low temperature and high humidity contributes more to respiratory infections, duing to the fact that recovery of the virus was higher at a higher relative humidity and the stability of the aerosol was at a maximum with relative humidity of 60%. Moreover, nature disaster or the extreme weather such as typhoon and heat wave may change the transmission and susceptibility to communicable disease. Therefore, we need motivate considerations to the influence of nonvccine-related factors on vaccination strategies. For many multi-strain pathogens there is evidence of a board, short-lived immune response immediately after infection with one strain that confers at least partial cross-protection against all strains of that pathogen (Reich et al. 2013). At the other hand, infections with one pathogen can affect the sverity, infectivity, or susceptibility to subsequent infection with other pathogens, and these effects can have profound clinical, epidemiological, and evolutionary implications (Shrestha et al. 2013). While the nature, strength, timing of the putative interaction between the influenza and pneumococcal pneumonia were well indentified on the individual and population levels (Weinberger et al. 2011) (Shrestha et al. 2013). However, whether the interaction among other infectious disease such as the hepatitis A, B, C and E is not clear. 5.3.3 Measure Indicators The measure indicators in the vaccine epidemioloy can be separated into three parts: regular epidemiological indicators, sociological indicators and indicators in special situation. The regular epidemiological indicators are attack rate, morbidity, mortality, fatality rate, et.al. There are no difference to the difination of that indicators between the vaccine epidemiology and tradtional epidemiology. Sociological indicators includes disability adjusted life year (DLAY) and cost benefit (effectivness) rate in the health ecconomic analysis. DLAY, which was jointly developed for the Global Burden of Disease (GBD) study by the World Bank, the World Health Organization (WHO) and the Harvard School of Public Health in the late 1980s, measures both mortality and morbidity and combines them in one single figure, allowing the comparison of health hazards and providing an evidence-based tool for healthcare policy prioritization and for monitoring intervention effects. Since its development, the DALY measure has been used widely in both national and global disease burden and cost-effectiveness studies (OOSTVOGELS et al. 2014). A specific property of infectious diseases that distinguishes them from chronic diseases is that infected persons who are treated may not only be cured (i.e. curative intervention) or protected against an infection (i.e. preventive intervention such as vaccination), but also that a successful intervention might reduce or prevent transmission of the pathogen to other susceptible persons(called herd immunity or indirect effect). If herd immunity has a large impact on transmission, dynamic transmission models are recommended for health economic analyses. (Jit and Brisson 2011). Mathematical modelling offers public health planners the ability to make predictions about the impact of emerging diseases as well as the effects of possible response and control measures. Such models are needed to bridge the gap between clinical trials and population-level use. This is particularly crucial for infectious diseases, where mass interventions such as vaccination and screening can result in effects on a population-level not seen on an individual level, including herd immunity, changes in the epidemiology of infection and changes to pathogen ecology as a consequence of selective pressure. The taxonomy categorises models based on whether (i) states in the model change over time (dynamic) or not (static), (ii) changes to the model occur at random (stochastic) or are fixed (deterministic), (iii) the model averages the behaviour of populations (aggregate) or tracks individuals (individual-based), (iv) events occur in discrete or continuous time, (v) individuals can enter or leave the population (open) or not (closed) and (vi) the model’s equations are linear or non-linear functions or parameters. The indicators in special situation contain basic reproduction number(RO) and Mininum relative single does efficacy. Reprouction number, is the number of secondary cases generated by a single individual over its entire infectious period in a complete susceptile population , which is commonly used to characterize pathogen transmissibility during a epidemic. The monitoring of R over time provides the feedback on the effectiveness of interventions (Griffin 2015). Mininum relative single does efficacy was firstly used to figure out, under what conditions the use of single-dose compaigns are expected to be as or more effictive than the two-dose compaigns with the same amount of vaccine (Andrew S. Azman et al. 2015). 5.4 Conclusion This is a short insight into vaccine epdemiology on the population level. Other issues like the adverse effects following immunization and vaccine clinic trials are not discussed in this blog. However, if you have any ideas on the AEFI or not things, just contact with me. Here, i will point out serveral analysis direction on vaccine epidemiology and hope that more people will contribute themself to the vaccine analysis. 1. The impact or ecconomic health analysis of the vaccine intervention on infectious disease. 2. Nonvccine-related factors such as meterological factors or air pollutant on infectious disease. 3. The spatial or temporal distribution on infectious disease and the outbreak detection. References "],
["incomplete-vaccination-with-an-imperfect-vaccine.html", "Chapter 6 Incomplete vaccination with an imperfect vaccine 6.1 Background 6.2 Introduction 6.3 Method 6.4 Results", " Chapter 6 Incomplete vaccination with an imperfect vaccine This is my reading notes from the paper: Pertussis immunity and epidemiology: mode and duration of vaccine-induced immunity, which was subjected on the nature, degree and durability of the vaccine protection. As the analysis codes were published on the website, therefore, i just have been editing the codes to suit the mumps (a contagious disease often breaks out in the highly vaccinated population recently) data in Zhejiang Province. 6.1 Background The resurgence of pertussis in some countries that maintain high vaccination coverage have drawn attention to the gaps in our understanding of the epidemiology effects of the pertussis vaccine. Candiate explantations range from the vaccine-driven evaluation of the aetiological agent, to the changes of the reporting and surveillance and lossing the efficience due to the swith from the whole cell pertussis vaccine to aP. The nature of the vaccine-induced protection can leave district footprints in the transient disease incidence patterns following the roll out of a vaccination program. The mode of the vaccine failure can determine the depth and duration of the honeymoon period, as well as the characteristics of the resurgence. Alought the immune memory shapes the epidemiological dynamics, the uncertainty can be reudced by the mechanistic model. 6.2 Introduction It has been shown that the nature of vaccine-induced protection can leave distinct footprints in the transient disease incidence patterns following the roll out a vaccination programme. In particular, the mode of the vaccine failure can determine the depth and duration of the honeymoon period, as well as the characteristcs of the resurgence. Vaccine effect on vaccine-preventable disease includes two aspects: Immunity against infection and immunity against transmission and disease. This is also the key point to understand the model structure and the flow among the different comparments. 6.2.1 Immunity against infection Three, not mutually exclusive, modes by which vaccines might fail in this goal are: Primary vaccine failure, a vaccine exhibit primary failure if it fails to provide any form of protection against infection to some fraction of the vaccinated people. Therefore, the primary vaccine failure is quantified by the fraction of vaccined individuals the vaccine fails to protect. Leakiness, a vaccine is said to be leakness when it readuced, but not eliminate the potential infection. The leakiness of a vaccine is measured by the probability of infection upon exposure for a vaccined individual relative to the same probability for an unvaccinated individual. Waning, vaccine indduced protection is said to wane when it cease after some time. Here, we quantify the speed of waning by the mean duration of protection, or, equivalently, its reciprocal, the rate at which immunity is lost. 6.2.2 Immunity against tramsimission and disease Even when a vaccine fail to provide the protection against infection, it might still reduced the infections’ transmissibility and or the severity of the disease sympoton. These effects can be qualityfied by: relative infectiousness, which is model as the ratio of the tramsimission rate of a vaccinated person to that of an unvaccinated person. relative reporting probability, the ratio of the reporting probability of a vaccinated individual relative to that of an unvaccinated individual. 6.3 Method Some statement: In the absence of primary vaccine failure, vaccinated individuals whose protection against infection has failure are likely to be recorded as cases (possibly due to the vaccine-induced protection against server disease) but may be just as infectious as unvaccinated individuals. Here, we relate our assumption of zero primary failure, considering models with modest levels of aP primary failure. For simplicity, infection and vaccine-derived immunity was assumed to be perfect and lifelong, althought the infection-derived immunity lasts longer than the vaccine-derived immunity. Transmission rate was assumed to be periodic function of time, with a period of 1 year. Parameters were estimated by fitting the deterministic models using the maximum likehood estimating via the trajectory matching. The best fits from the initial runs were used to starting points for the subsequent iterations of the trajectory matching to reveal the ML estimate. A profile is derived by creat an array of fixed values for a parameter and maximizing the likehood at each fixed value over the remaining model parameters. 6.3.1 Data Monthly reportes for six regions from the beginning of 1996 until the end of 2009. Regional demographic data: population size, annual number of live births and deaths. The covaerage of aP and the vaccination schedule. 6.3.2 Model A standard Susceptible-exposed-infected-recoverd (SEIR) model with eight compartments. It includes two compartments each of susceptible (S_{i}), exposed(E_{I}) and infected (I_{i}) compartments in order to distinguish individuals who were never vaccinated (i=1) from those who vaccinated (i=2). The vaccinated compartment contained individuals who were vaccinated and still maintain some vaccine-derived protection against infection. In others words, there are a spectrum of models, differing in certain parameters and not in others, that were all roughly equally well-supported by the data. One dimensional likelihood profile was performed to provide the value of the best likelihoods which can be obtained at the fixed values of the profile parameter by maximizing over all the remaining model parameters. Fox each region, we started the profiling procedure by dividing the profile parameter’s given range into equally spaced intervals , then, we gathered all the points from the early searches where the profile parameter had values that fell within the interval and selected the point with the highest likelihood. To refine the profine on the initial profile, we created the seven copies of the initial and perturbed the value of the profile paramter by multiplying it by the 0.95^3, 0.95^2,0.95, 1.00,1.05,1.052,1.053( It depends on the rw.sd arguement). A local proflle was generated for each region using the 100 equally spaced intervals over the entire allowed range of each profile parameter and selected the points with the highest likehood whose profile parameter falls within the interval. A function was then fit through the collection of points using local regression (locfit package). 6.4 Results Deterministic model do not explain the data as well as the stochastic models. Relative infectiousness of vaccinated infected individual is equal to that of unvaccinated ones. Full model has to many degress of freedom for these parameters(wanning and leakiness) to be uniquely indentiable. In others words, there are a spectrum of models, differing in certain parameters and not in others, that were all roughly equally well-supported by the data. Low relatively reporting probability can be interpreted that the preponderance of infection in the vaccinated individuals are mild or asymptomatic, which indicated that the vaccine does benefit individuals directly by diminishing disease severity. "]
]
