<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Vaccine Epidemiology</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology">
  <meta name="generator" content="bookdown 0.0.71 and GitBook 2.6.7">

  <meta property="og:title" content="Vaccine Epidemiology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology" />
  <meta name="github-repo" content="spatial-r/Vaccineepidemiology" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Vaccine Epidemiology" />
  
  <meta name="twitter:description" content="This books includes some reading notes from the published books or papers, analysis method with some real datasets and short insight on the vaccine epidemiology" />
  

<meta name="author" content="Bing Zhang">

<meta name="date" content="2016-05-29">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="reproduction-numbers-during-epidemics.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Vaccine Epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html"><i class="fa fa-check"></i><b>2</b> Bayesian Infectious Dynamics Model in Discrete Time</a><ul>
<li class="chapter" data-level="2.1" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#model-and-parameters"><i class="fa fa-check"></i><b>2.2</b> Model and Parameters</a></li>
<li class="chapter" data-level="2.3" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#packages"><i class="fa fa-check"></i><b>2.3</b> Packages</a></li>
<li class="chapter" data-level="2.4" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#examples-and-codes"><i class="fa fa-check"></i><b>2.4</b> Examples and Codes</a></li>
<li class="chapter" data-level="2.5" data-path="bayesian-infectious-dynamics-model-in-discrete-time.html"><a href="bayesian-infectious-dynamics-model-in-discrete-time.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html"><i class="fa fa-check"></i><b>3</b> Reproduction numbers during epidemics</a><ul>
<li class="chapter" data-level="3.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#basic-reproduction-number"><i class="fa fa-check"></i><b>3.1</b> Basic reproduction number</a></li>
<li class="chapter" data-level="3.2" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#package-r0"><i class="fa fa-check"></i><b>3.2</b> Package R0</a><ul>
<li class="chapter" data-level="3.2.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#example-and-code"><i class="fa fa-check"></i><b>3.2.1</b> Example and code</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#package-epiestim"><i class="fa fa-check"></i><b>3.3</b> Package EpiEstim</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reproduction-numbers-during-epidemics.html"><a href="reproduction-numbers-during-epidemics.html#example-and-code-1"><i class="fa fa-check"></i><b>3.3.1</b> Example and code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html"><i class="fa fa-check"></i><b>4</b> Spatial-temporal Multicomponent Model</a><ul>
<li class="chapter" data-level="4.1" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.1"><i class="fa fa-check"></i><b>4.1</b> 模型综述</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.2"><i class="fa fa-check"></i><b>4.2</b> 模型优点</a></li>
<li class="chapter" data-level="4.3" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3"><i class="fa fa-check"></i><b>4.3</b> 具体实例</a><ul>
<li class="chapter" data-level="4.3.1" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#sts"><i class="fa fa-check"></i><b>4.3.1</b> STS数据</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.2"><i class="fa fa-check"></i><b>4.3.2</b> 数据可视化</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.3"><i class="fa fa-check"></i><b>4.3.3</b> 模型拟合</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.3.4"><i class="fa fa-check"></i><b>4.3.4</b> 纳入协变量</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#power-law"><i class="fa fa-check"></i><b>4.3.5</b> Power-law</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#random-effect"><i class="fa fa-check"></i><b>4.3.6</b> Random effect</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatial-temporal-multicomponent-model.html"><a href="spatial-temporal-multicomponent-model.html#section-4.4"><i class="fa fa-check"></i><b>4.4</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html"><i class="fa fa-check"></i><b>5</b> Vaccine Epidemiology: A short insight</a><ul>
<li class="chapter" data-level="5.1" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#background"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#introduction-1"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
<li class="chapter" data-level="5.3" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-epdemiology"><i class="fa fa-check"></i><b>5.3</b> Vaccine Epdemiology</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-related-items"><i class="fa fa-check"></i><b>5.3.1</b> Vaccine-related Items</a></li>
<li class="chapter" data-level="5.3.2" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#vaccine-strategies"><i class="fa fa-check"></i><b>5.3.2</b> Vaccine Strategies</a></li>
<li class="chapter" data-level="5.3.3" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#measure-indicators"><i class="fa fa-check"></i><b>5.3.3</b> Measure Indicators</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vaccine-epidemiology-a-short-insight.html"><a href="vaccine-epidemiology-a-short-insight.html#conclusion-1"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html"><i class="fa fa-check"></i><b>6</b> Incomplete vaccination with an imperfect vaccine</a><ul>
<li class="chapter" data-level="6.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#background-1"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#introduction-2"><i class="fa fa-check"></i><b>6.2</b> Introduction</a><ul>
<li class="chapter" data-level="6.2.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#immunity-against-infection"><i class="fa fa-check"></i><b>6.2.1</b> Immunity against infection</a></li>
<li class="chapter" data-level="6.2.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#immunity-against-tramsimission-and-disease"><i class="fa fa-check"></i><b>6.2.2</b> Immunity against tramsimission and disease</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#method"><i class="fa fa-check"></i><b>6.3</b> Method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#data"><i class="fa fa-check"></i><b>6.3.1</b> Data</a></li>
<li class="chapter" data-level="6.3.2" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#model"><i class="fa fa-check"></i><b>6.3.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="incomplete-vaccination-with-an-imperfect-vaccine.html"><a href="incomplete-vaccination-with-an-imperfect-vaccine.html#results"><i class="fa fa-check"></i><b>6.4</b> Results</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Vaccine Epidemiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-infectious-dynamics-model-in-discrete-time" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Bayesian Infectious Dynamics Model in Discrete Time</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
<p>Modeling the infectious disease dynamics can be done at individual level as well as population level, moreover, both provide an accurate description of the spread (progress) of infectious diseases in the coresponding situation. Individual-level model allows for the heterogeneity in a population via the individual covariates(Some packages:). While, when the analysis dataset is aggregated at the regular interval and information regarding individual movement and contact behavior is not available, model on population level is more suitable.<br />
 Compartmental models are usually written using the ordinary differential equations and divide the population into serveral distinct compartments(categories) according to disease status, which is widely applied in the continuous times deterministic model previously <span class="citation">(Cai et al. <a href="#ref-Cai_2013">2013</a>)</span>. Majority of them are based on the assumption that all the individuals are equally likely to contact any other individuals in that population. Actually, when the size of compartments is large enough, the assumption of homogeneous mixing is indeed reasonal(appropriate). However, the situation at the most onset of epidemics is usually quite different, since most of the individuals in the population are susceptible and the number of infected is small. In addition, stochastic(<strong>demographical and environmental stochasticity</strong>) model based on a probability of disease contagion provide a more natural description of the transmission of infectious diseases, especially on those occasions where the data have been recorded over predetermined discrete time intervals<span class="citation">(Allen <a href="#ref-Allen_2014">2014</a>)</span> <span class="citation">(Corber\a’an-Vallet and Santonja <a href="#ref-Corber_n_Vallet_2014">2014</a>)</span>. Consequently, we introduce two stochastic compartmental model in discrete time <span class="citation">(Finkenstädt and Grenfell <a href="#ref-Finkenst_dt_2000">2000</a>)</span> from the publised literatures as well as the analysis codes, aiming to provide a deeper insight into the underlying processes driving historical population dynamics. In spite of this, we also give serveral continuous times deterministic models and all of them can be found in <a href="https://github.com/Spatial-R/Dynamic-Model-for-Infectious-Disease">Github</a>.</p>
</div>
<div id="model-and-parameters" class="section level2">
<h2><span class="header-section-number">2.2</span> Model and Parameters</h2>
<p>Firstly, let <span class="math inline">\(y_{i}\)</span> denote the number of hopspitalization for the infectious disease reported at time <span class="math inline">\(t( t \in {1,2,3,..,T})\)</span>.The time can be formulated as week, month or season. At the first level of the model hierarchy, we assume that the observations follow a binomial distribution: <span class="math display">\[
 \begin{aligned}
  y_{t} \sim Bi(i_{t},\rho)
 \end{aligned}
 \]</span> where <span class="math inline">\(i_{t}\)</span> is the number of new infectious at time <span class="math inline">\(t\)</span> and <span class="math inline">\(\rho\)</span> is the probability of being hospitalized for the infectious disease, which also illustrates the correcting factor for geographical discrepancy. The number of newly infected individuals at time <span class="math inline">\(t\)</span> can be modeled as <span class="math display">\[
\begin{aligned}
 i_{t} \sim Bi(S_{t-1},P_{t})
\end{aligned}
\]</span> where <span class="math inline">\(S_{t-1}\)</span> is the susceptible population at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(P_{t}\)</span> is the probability of becoming infected at time <span class="math inline">\(t\)</span>. Here, you also can use the Possion distribution (<strong>Note:</strong> Which distribution to choose depends on the population you analysis. If the population is finite, the Binomial distribution is considered).</p>
<p>For Susceptible-Infected(SI), SIR(Susceptible-Infected-Recovery), SIRS (Susceptible-Infected-Recovery-Susceptible), and so on, all the infectious models can use the bayesian method to obtain the posterior distribution of the model parameters. Here, we take the SIR model with constant population for example, and the number of susceptible,<span class="math inline">\(S_{t}\)</span>, infected, <span class="math inline">\(I_{t}\)</span>, and the recovery,<span class="math inline">\(R_{t}\)</span> at time <span class="math inline">\(t\)</span> are given the followed recursion equtions: <span class="math display">\[
\begin{aligned}
S_{t}=S_{t-1}-i_{t}+N*\mu-\mu*S_{t-1} \\\\
I_{t}=I_{t-1}-\gamma*I_{t-1}+i_{t}-I_{t-1}*\mu  \\\\
R_{t}=R_{t-1}+\gamma*I_{t-1}-R_{t-1}*\mu  \\\\
\end{aligned}
\]</span> where <span class="math inline">\(\mu\)</span> is the death rate and the birth rate,<span class="math inline">\(\gamma\)</span> is the proportion of infectious individuals that recover per unit time; N is the total population size.</p>
<p>Finally, we need to model the parameter <span class="math inline">\(P_{t}\)</span> in the second equation taking into consideration for the following condition. Firstly, this probability must lie in the interval 0-1.Secondly, <span class="math inline">\(P_{t}\)</span> must considerate the transimissible nature of the infection and so dependence on the previous number of the infected individuals is advisable. This can be easily achieved by modeling the logit of <span class="math inline">\(P_{t}\)</span>, which is defined as <span class="math inline">\(logit(P-{t})=log(\frac{P_{t}}{(1-P_{t})})\)</span>. In particular, we model the <span class="math inline">\(logit(P_{t})\)</span> as : <span class="math display">\[
\begin{aligned}
logit(P-{t})=log(\frac{P_{t}}{(1-P_{t})})=\alpha*log(i_{t-1})+r_{t}
\end{aligned}
\]</span> where the <span class="math inline">\(exp{r_{t}}\)</span> represents the time-varing transmission rate and the mixing parameter <span class="math inline">\(\alpha\)</span> allows for heterogeneous mixing. Taking the mixing parameter <span class="math inline">\(\alpha=1\)</span> would correspond to the assumption of mass action. The equation aboved can also be writen as: <span class="math display">\[
\begin{aligned}
P_{t}=\frac{i^{\alpha}_{t-1}*exp(r_{t})}{(1+i^{\alpha}_{t-1}*exp(r_{t}))}=
(\frac{i^{\alpha}_{t-1}*exp(r_{t})}{(1+i^{\alpha}_{t-1}*exp(r_{t}))}+c,1)
\end{aligned}
\]</span> In order to account for the occurrrance of new cases after the disease has faded out, we add the paramter <span class="math inline">\(c\)</span> to the model, which represents a constant probability of becoming infected. Fox example, the population can be infected by the individuals outside the population under study. The Uniform distribution in the interval (0,0.01) is assigned to parameter <span class="math inline">\(c\)</span>.</p>
<p>The key feature of our model fformulation is the transimission rate, <strong><span class="math inline">\(exp(r_{t})\)</span></strong>, which is allowed to vary stochastically over time. Here, we present four alternative formulations of the SIR model in discrete time: Two stochastical formulation with different definations of transimmision rate and two deterministic formulations.</p>
<ul>
<li><p><strong>Alternative 1</strong>: Stochastical model with a deterministic seasonal transimmision rate <span class="math inline">\(exp(r_{t})\)</span>, where:<br />
<span class="math display">\[  
\begin{aligned}
r_{t}=r_{0}+\sum\limits_{k=1}^{K}(r_{2k-1}*sin(\frac{2k*\pi*t}{freq})+r_{2k}*cos(\frac{2k*\pi*t}{freq}))
\end{aligned}
\]</span> The transimmision rate is allowed to vary over seasonally. However, there are no weekly random effects, the seasonal pattern repeats over time.</p></li>
<li><strong>Alternative 2</strong>: Stochastical model where the transimmision rate is assumed to be constant over time, where: <span class="math display">\[  
\begin{aligned}
  exp(r_{t})=exp(r)
\end{aligned}
\]</span></li>
<li><p><strong>Alternative 3</strong>: Deterministical model with a seasonal transimmision rate. Within the model formulation, the number of hospitalizations at time t is given by: <span class="math display">\[  
\begin{aligned}
  y_{t}=S_{t-1}*y_{t-1}*\lambda _{t}
\end{aligned}
\]</span> where <span class="math inline">\(\lambda_{t}\)</span>, which is equivalent to the the paramter <span class="math inline">\(exp(r_{t})\)</span>, respresents the effective contact rate. Here we model the parameter <span class="math inline">\(\lambda_{t}\)</span> as: <span class="math display">\[  
\begin{aligned}
\lambda_{t}=r_{0}+\sum\limits_{k=1}^{K}(r_{2k-1}*sin(\frac{2k*\pi*t}{freq})+r_{2k}*cos(\frac{2k*\pi*t}{freq}))
\end{aligned}
\]</span></p></li>
<li><p><strong>Alternative 4</strong>: Deterministical model with a constant transimmision rate. This model is similar to the previous one with <span class="math inline">\(\lambda_{t}=\lambda\)</span>. The number of the hospitalizations at time <span class="math inline">\(t\)</span> is <span class="math inline">\(y_{t}=S_{t-1}*y_{t-1}*\lambda\)</span>.</p></li>
</ul>
<p>All the analysis codes can be found in the author’s website. Therefore, just try it!</p>
</div>
<div id="packages" class="section level2">
<h2><span class="header-section-number">2.3</span> Packages</h2>
<p>Here, i will introduce another R package to fit the TSIR model for infectious disease. You can install the <strong>tsiR</strong> package via devtools from the author’s <a href="https://github.com/adbecker/tsiR">Github</a>. The method used in the package comes from the paper: <strong>Predictability in a highly stochastic system: final size of measles epidemics in small populations </strong>. Basic formula of analysis dataset consists five clolumns including <strong>time</strong>, <strong>cases</strong>,<strong>births</strong>, <strong>pop</strong> and <strong>IP</strong>(infectious period) can be created using the <strong>tsiRdata</strong> function. Other functions can be seen in the fellow part:</p>
<table style="width:107%;">
<colgroup>
<col width="15%" />
<col width="91%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>estpars</code></td>
<td align="left">Using simple regression: reconstructs susceptibles and estimates parameters</td>
</tr>
<tr class="even">
<td align="left"><code>maxthreshold</code></td>
<td align="left">Using simple regression: optimizes the threshold parameter for sparse data</td>
</tr>
<tr class="odd">
<td align="left"><code>mcmcestpars</code></td>
<td align="left">Using MCMC: reconstructions susceptibles and estimates parameters</td>
</tr>
<tr class="even">
<td align="left"><code>mcmctsir</code></td>
<td align="left">Using MCMC: reconstructions susceptibles, estimates parameters, and runs the simulation</td>
</tr>
<tr class="odd">
<td align="left"><code>plotcases</code></td>
<td align="left">Plots just the cases data</td>
</tr>
<tr class="even">
<td align="left"><code>plotcomp</code></td>
<td align="left">Plots the data versus the simulations</td>
</tr>
<tr class="odd">
<td align="left"><code>plotdata</code></td>
<td align="left">Plots the (interpolated) cases, births, and population time series</td>
</tr>
<tr class="even">
<td align="left"><code>plotres</code></td>
<td align="left">Plots the fitted regressions, reporting, susceptible reconstruction, estimated parameters, and the fit diagonstics</td>
</tr>
<tr class="odd">
<td align="left"><code>runtsir</code></td>
<td align="left">Using simple regression: reconstructions suceptibles, estimates parameters, and runs the simulation</td>
</tr>
<tr class="even">
<td align="left"><code>simulatetsir</code></td>
<td align="left">Runs the simulation taking in the output from <code>estpars</code> or <code>mcmcestpars</code></td>
</tr>
<tr class="odd">
<td align="left"><code>tsiRdata</code></td>
<td align="left">Interpolates cases, births, and pop vectors to the generation time of the disease</td>
</tr>
<tr class="even">
<td align="left"><code>twentymeas</code></td>
<td align="left">Complete biweekly (IP=2) data sets from twenty UK cities</td>
</tr>
</tbody>
</table>
<p>Something need to be keep in mind is that the reconstruction for susceptible population in TSIR model is crutial. As the TSIR model assumes that all individuals will eventually become infected, the incidence must therefore track the number of births:<br />
<span class="math display">\[  
\begin{aligned}
   S_{t}=\overline{S}+Z_{t} 
\end{aligned}
\]</span> <span class="math display">\[  
\begin{aligned}
   Z_{t+1}=\sum\limits_{i=1}^{t}(B_{i-d})-\sum\limits_{i=1}^{t}(\rho_{i}*C_{i})+\sum\limits_{i=1}^{t}(\mu_{i})+Z_{0}
\end{aligned}
\]</span> Assuming <span class="math inline">\(\mu_{t}\)</span> is small, then <span class="math inline">\(\\rho_{t}\)</span> can be estimated using local regression between the cummulative observed cases and the cummulative births with the <span class="math inline">\(Z_{t}\)</span> as the residuals of the regreesion. How to use the function can be obtained form the code <strong>?function_name</strong>. Serveral arguments should be treated cautiously, including <strong>IP</strong>(infectious period in weeks),<strong>alpha</strong>(maxing parameter, set 0.97), <strong>sbar</strong>(mean number of susceptibles, can be estimated from dataset), <strong>seasonality</strong>( can be one of “standard”, “schoolterm” or “none”), <strong>regtype</strong>(regression used in susceptible reconstruction. Options are “gaussian”“,”lm“(linear model),”spline“(smooth.spline with 2.5 degrees freedom),”lowess“(with f = 2/3, iter = 1),”loess“(degree 1), and”user&quot; which is just a user inputed vector), <strong>epidemics</strong>(whether to split the data up, two options: cont and break), <strong>threshold</strong>(cut off for a new epidemic if epidemics = “break”, can be fit by maximizing Rsquared predictions using the <em>maxthreshold</em> function, details can found <span class="citation">(Caudron et al. <a href="#ref-Caudron_2014">2014</a>)</span>).</p>
</div>
<div id="examples-and-codes" class="section level2">
<h2><span class="header-section-number">2.4</span> Examples and Codes</h2>
<p>Actually, we can use the <strong>estpars</strong> and <strong>mcmcestpars</strong> function to get the estimate parameters, *maxthreshold<strong> function for the thresthod parameter, </strong>mcmctsir<strong> and </strong>mcmctsir** to run the simulations on MCMC and simple regression respectively. Here, we use the dataset in tsiR package to carry out a simple analysis and corresponding codes are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tsiR);<span class="kw">require</span>(kernlab)
<span class="kw">require</span>(ggplot2);<span class="kw">require</span>(reshape2);<span class="kw">require</span>(grid)</code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MoldMeas &lt;-<span class="st"> </span>twentymeas[[<span class="st">&quot;Mold&quot;</span>]]
parms &lt;-<span class="st"> </span><span class="kw">estpars</span>(<span class="dt">data=</span>MoldMeas,<span class="dt">alpha=</span><span class="fl">0.97</span>,<span class="dt">IP=</span><span class="dv">2</span>)
tau &lt;-<span class="st"> </span><span class="kw">maxthreshold</span>(<span class="dt">data=</span>MoldMeas,<span class="dt">parms=</span>parms,<span class="dt">IP=</span><span class="dv">2</span>)
MoldRes &lt;-<span class="st"> </span><span class="kw">simulatetsir</span>(<span class="dt">data=</span>MoldMeas,<span class="dt">parms=</span>parms,<span class="dt">epidemics=</span><span class="st">&quot;break&quot;</span>,<span class="dt">threshold=</span>tau,<span class="dt">nsim=</span><span class="dv">10</span>,<span class="dt">method=</span><span class="st">&quot;negbin&quot;</span>)
<span class="kw">plotres</span>(MoldRes)</code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level2">
<h2><span class="header-section-number">2.5</span> Conclusion</h2>
<p>Utimately, TSIR model with stochastical effect from environment and demographics provides a knowledge on the dynamics of infectious diseases, while possible improvements include the use of statistical models such as trajectory matching or hidden Markov models to infer a biweekly incidence rate rather than using a linear interpolant is essential. Fortunately, Prof. Aaron A. King has established a <a href="http://kingaa.github.io/pomp/">pomp</a> package, which provides a very general realization of nonliner partially-observed Markov processes model. I will give a short introduction about the analysis on Mumps dynamics using <strong>pomp</strong> package in the next chapter.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Cai_2013">
<p>Cai, Yongli, Xixi Wang, Weiming Wang, and Min Zhao. 2013. “Stochastic Dynamics of an SIRS Epidemic Model with Ratio-Dependent Incidence Rate.” <em>Abstract and Applied Analysis</em> 2013. Hindawi Publishing Corporation: 1–11. doi:<a href="https://doi.org/10.1155/2013/172631">10.1155/2013/172631</a>.</p>
</div>
<div id="ref-Allen_2014">
<p>Allen, Edward J. 2014. “Derivation and Computation of Discrete-Delay and Continuous-Delay SDEs in Mathematical Biology.” <em>MBE</em> 11 (3). American Institute of Mathematical Sciences (AIMS): 403–25. doi:<a href="https://doi.org/10.3934/mbe.2014.11.403">10.3934/mbe.2014.11.403</a>.</p>
</div>
<div id="ref-Corber_n_Vallet_2014">
<p>Corber\a’an-Vallet, Ana, and Francisco J. Santonja. 2014. “A Bayesian SIRS Model for the Analysis of Respiratory Syncytial Virus in the Region of Valencia, Spain.” <em>Biom. J.</em> 56 (5). Wiley-Blackwell: 808–18. doi:<a href="https://doi.org/10.1002/bimj.201300194">10.1002/bimj.201300194</a>.</p>
</div>
<div id="ref-Finkenst_dt_2000">
<p>Finkenstädt, B. F., and B. T. Grenfell. 2000. “Time Series Modelling of Childhood Diseases: A Dynamical Systems Approach.” <em>J. R. Stat. Soc. Ser. C</em> 49 (2). Wiley-Blackwell: 187–205. doi:<a href="https://doi.org/10.1111/1467-9876.00187">10.1111/1467-9876.00187</a>.</p>
</div>
<div id="ref-Caudron_2014">
<p>Caudron, Q., A. S. Mahmud, C. J. E. Metcalf, M. Gottfrethsson, C. Viboud, A. D. Cliff, and B. T. Grenfell. 2014. “Predictability in a Highly Stochastic System: Final Size of Measles Epidemics in Small Populations.” <em>Journal of The Royal Society Interface</em> 12 (102). The Royal Society: 20141125–5. doi:<a href="https://doi.org/10.1098/rsif.2014.1125">10.1098/rsif.2014.1125</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproduction-numbers-during-epidemics.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/Post/Method1.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
